(function(e,t){'object'==typeof exports&&'undefined'!=typeof module?t(exports):'function'==typeof define&&define.amd?define(['exports'],t):t(e['@eris/image']=e['@eris/image']||{})})(this,function(e){'use strict';function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,'default')?e['default']:e}function a(e,t){return t={exports:{}},e(t,t.exports),t.exports}function n(e){var t=e.length;if(0<t%4)throw new Error('Invalid string. Length must be a multiple of 4');var a=e.indexOf('=');-1===a&&(a=t);var n=a===t?0:4-a%4;return[a,n]}function o(e){var t=n(e),a=t[0],i=t[1];return 3*(a+i)/4-i}function r(e,t,a){return 3*(t+a)/4-a}function s(e){for(var t,a=n(e),o=a[0],s=a[1],d=new M(r(e,o,s)),l=0,h=0<s?o-4:o,g=0;g<h;g+=4)t=B[e.charCodeAt(g)]<<18|B[e.charCodeAt(g+1)]<<12|B[e.charCodeAt(g+2)]<<6|B[e.charCodeAt(g+3)],d[l++]=255&t>>16,d[l++]=255&t>>8,d[l++]=255&t;return 2===s&&(t=B[e.charCodeAt(g)]<<2|B[e.charCodeAt(g+1)]>>4,d[l++]=255&t),1===s&&(t=B[e.charCodeAt(g)]<<10|B[e.charCodeAt(g+1)]<<4|B[e.charCodeAt(g+2)]>>2,d[l++]=255&t>>8,d[l++]=255&t),d}function d(e){return F[63&e>>18]+F[63&e>>12]+F[63&e>>6]+F[63&e]}function l(e,t,a){for(var n,o=[],r=t;r<a;r+=3)n=(16711680&e[r]<<16)+(65280&e[r+1]<<8)+(255&e[r+2]),o.push(d(n));return o.join('')}function h(e){for(var t,a=e.length,n=a%3,o=[],r=16383,s=0,i=a-n;s<i;s+=r)o.push(l(e,s,s+r>i?i:s+r));return 1==n?(t=e[a-1],o.push(F[t>>2]+F[63&t<<4]+'==')):2==n&&(t=(e[a-2]<<8)+e[a-1],o.push(F[t>>10]+F[63&t>>4]+F[63&t<<2]+'=')),o.join('')}for(var g=Number.isInteger,p=Math.ceil,u=Math.max,f=Math.sqrt,c=Math.cos,m=Math.PI,_=Math.round,y=String.fromCharCode,I=Math.min,C=Math.floor,D=Math.abs,b=Math.pow,x='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,S=o,P=s,w=h,F=[],B=[],M='undefined'==typeof Uint8Array?Array:Uint8Array,R='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',T=0,i=R.length;T<i;++T)F[T]=R[T],B[R.charCodeAt(T)]=T;B[45]=62,B[95]=63;var E={byteLength:S,toByteArray:P,fromByteArray:w},v={read:function(t,a,n,o,r){var l,e,h=8*r-o-1,g=(1<<h)-1,p=g>>1,u=-7,f=n?r-1:0,i=n?-1:1,d=t[a+f];for(f+=i,l=d&(1<<-u)-1,d>>=-u,u+=h;0<u;l=256*l+t[a+f],f+=i,u-=8);for(e=l&(1<<-u)-1,l>>=-u,u+=o;0<u;e=256*e+t[a+f],f+=i,u-=8);if(0===l)l=1-p;else{if(l===g)return e?NaN:(d?-1:1)*Infinity;e+=b(2,o),l-=p}return(d?-1:1)*e*b(2,l-o)},write:function(t,a,n,o,r,l){var h,g,p,u=8*l-r-1,f=(1<<u)-1,c=f>>1,m=23===r?5.960464477539063e-8-6.617444900424222e-24:0,y=o?0:l-1,i=o?1:-1,d=0>a||0===a&&0>1/a?1:0;for(a=D(a),isNaN(a)||a===Infinity?(g=isNaN(a)?1:0,h=f):(h=C(Math.log(a)/Math.LN2),1>a*(p=b(2,-h))&&(h--,p*=2),a+=1<=h+c?m/p:m*b(2,1-c),2<=a*p&&(h++,p/=2),h+c>=f?(g=0,h=f):1<=h+c?(g=(a*p-1)*b(2,r),h+=c):(g=a*b(2,c-1)*b(2,r),h=0));8<=r;t[n+y]=255&g,y+=i,g/=256,r-=8);for(h=h<<r|g,u+=r;0<u;t[n+y]=255&h,y+=i,h/=256,u-=8);t[n+y-i]|=128*d}},G=a(function(e,t){function a(e){if(e>Z)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=n.prototype,t}function n(e,t,a){if('number'==typeof e){if('string'==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return s(e)}return i(e,t,a)}function i(e,t,a){if('string'==typeof e)return d(e,t);if(ArrayBuffer.isView(e))return l(e);if(null==e)throw TypeError('The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type '+typeof e);if(V(e,ArrayBuffer)||e&&V(e.buffer,ArrayBuffer))return h(e,t,a);if('number'==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return n.from(i,t,a);var o=g(e);if(o)return o;if('undefined'!=typeof Symbol&&null!=Symbol.toPrimitive&&'function'==typeof e[Symbol.toPrimitive])return n.from(e[Symbol.toPrimitive]('string'),t,a);throw new TypeError('The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type '+typeof e)}function o(e){if('number'!=typeof e)throw new TypeError('"size" argument must be of type number');else if(0>e)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function r(e,t,n){return o(e),0>=e?a(e):void 0===t?a(e):'string'==typeof n?a(e).fill(t,n):a(e).fill(t)}function s(e){return o(e),a(0>e?0:0|p(e))}function d(e,t){if(('string'!=typeof t||''===t)&&(t='utf8'),!n.isEncoding(t))throw new TypeError('Unknown encoding: '+t);var i=0|u(e,t),o=a(i),r=o.write(e,t);return r!==i&&(o=o.slice(0,r)),o}function l(e){for(var t=0>e.length?0:0|p(e.length),n=a(t),o=0;o<t;o+=1)n[o]=255&e[o];return n}function h(e,t,a){if(0>t||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(a||0))throw new RangeError('"length" is outside of buffer bounds');var i;return i=void 0===t&&void 0===a?new Uint8Array(e):void 0===a?new Uint8Array(e,t):new Uint8Array(e,t,a),i.__proto__=n.prototype,i}function g(e){if(n.isBuffer(e)){var t=0|p(e.length),i=a(t);return 0===i.length?i:(e.copy(i,0,0,t),i)}return void 0===e.length?'Buffer'===e.type&&Array.isArray(e.data)?l(e.data):void 0:'number'!=typeof e.length||q(e.length)?a(0):l(e)}function p(e){if(e>=Z)throw new RangeError('Attempt to allocate Buffer larger than maximum size: 0x'+Z.toString(16)+' bytes');return 0|e}function u(e,t){if(n.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||V(e,ArrayBuffer))return e.byteLength;if('string'!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var a=e.length,i=2<arguments.length&&!0===arguments[2];if(!i&&0===a)return 0;for(var o=!1;;)switch(t){case'ascii':case'latin1':case'binary':return a;case'utf8':case'utf-8':return H(e).length;case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return 2*a;case'hex':return a>>>1;case'base64':return J(e).length;default:if(o)return i?-1:H(e).length;t=(''+t).toLowerCase(),o=!0;}}function f(e,t,a){var n=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return'';if((void 0===a||a>this.length)&&(a=this.length),0>=a)return'';if(a>>>=0,t>>>=0,a<=t)return'';for(e||(e='utf8');;)switch(e){case'hex':return G(this,t,a);case'utf8':case'utf-8':return B(this,t,a);case'ascii':return R(this,t,a);case'latin1':case'binary':return T(this,t,a);case'base64':return F(this,t,a);case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return A(this,t,a);default:if(n)throw new TypeError('Unknown encoding: '+e);e=(e+'').toLowerCase(),n=!0;}}function c(e,t,a){var n=e[t];e[t]=e[a],e[a]=n}function m(e,t,a,i,o){if(0===e.length)return-1;if('string'==typeof a?(i=a,a=0):2147483647<a?a=2147483647:-2147483648>a&&(a=-2147483648),a=+a,q(a)&&(a=o?0:e.length-1),0>a&&(a=e.length+a),a>=e.length){if(o)return-1;a=e.length-1}else if(0>a)if(o)a=0;else return-1;if('string'==typeof t&&(t=n.from(t,i)),n.isBuffer(t))return 0===t.length?-1:x(e,t,a,i,o);if('number'==typeof t)return t&=255,'function'==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,a):Uint8Array.prototype.lastIndexOf.call(e,t,a):x(e,[t],a,i,o);throw new TypeError('val must be string, number or Buffer')}function x(e,t,a,n,o){function r(e,t){return 1==s?e[t]:e.readUInt16BE(t*s)}var s=1,d=e.length,l=t.length;if(void 0!==n&&(n=(n+'').toLowerCase(),'ucs2'===n||'ucs-2'===n||'utf16le'===n||'utf-16le'===n)){if(2>e.length||2>t.length)return-1;s=2,d/=2,l/=2,a/=2}var h;if(o){var i=-1;for(h=a;h<d;h++)if(r(e,h)!==r(t,-1==i?0:h-i))-1!=i&&(h-=h-i),i=-1;else if(-1==i&&(i=h),h-i+1===l)return i*s}else for(a+l>d&&(a=d-l),h=a;0<=h;h--){for(var g=!0,p=0;p<l;p++)if(r(e,h+p)!==r(t,p)){g=!1;break}if(g)return h}return-1}function _(e,t,a,n){a=+a||0;var o=e.length-a;n?(n=+n,n>o&&(n=o)):n=o;var r=t.length;n>r/2&&(n=r/2);for(var s,d=0;d<n;++d){if(s=parseInt(t.substr(2*d,2),16),q(s))return d;e[a+d]=s}return d}function C(e,t,a,n){return j(H(t,e.length-a),e,a,n)}function D(e,t,a,n){return j(U(t),e,a,n)}function S(e,t,a,n){return D(e,t,a,n)}function P(e,t,a,n){return j(J(t),e,a,n)}function w(e,t,a,n){return j(W(t,e.length-a),e,a,n)}function F(e,t,a){return 0===t&&a===e.length?E.fromByteArray(e):E.fromByteArray(e.slice(t,a))}function B(e,t,a){a=I(e.length,a);for(var n=[],o=t;o<a;){var i=e[o],r=null,s=239<i?4:223<i?3:191<i?2:1;if(o+s<=a){var d,l,h,g;1==s?128>i&&(r=i):2==s?(d=e[o+1],128==(192&d)&&(g=(31&i)<<6|63&d,127<g&&(r=g))):3==s?(d=e[o+1],l=e[o+2],128==(192&d)&&128==(192&l)&&(g=(15&i)<<12|(63&d)<<6|63&l,2047<g&&(55296>g||57343<g)&&(r=g))):4==s?(d=e[o+1],l=e[o+2],h=e[o+3],128==(192&d)&&128==(192&l)&&128==(192&h)&&(g=(15&i)<<18|(63&d)<<12|(63&l)<<6|63&h,65535<g&&1114112>g&&(r=g))):void 0}null===r?(r=65533,s=1):65535<r&&(r-=65536,n.push(55296|1023&r>>>10),r=56320|1023&r),n.push(r),o+=s}return M(n)}function M(e){var t=e.length;if(t<=K)return y.apply(String,e);for(var a='',n=0;n<t;)a+=y.apply(String,e.slice(n,n+=K));return a}function R(e,t,a){var n='';a=I(e.length,a);for(var o=t;o<a;++o)n+=y(127&e[o]);return n}function T(e,t,a){var n='';a=I(e.length,a);for(var o=t;o<a;++o)n+=y(e[o]);return n}function G(e,t,a){var n=e.length;(!t||0>t)&&(t=0),(!a||0>a||a>n)&&(a=n);for(var o='',r=t;r<a;++r)o+=Y(e[r]);return o}function A(e,t,a){for(var n=e.slice(t,a),o='',r=0;r<n.length;r+=2)o+=y(n[r]+256*n[r+1]);return o}function L(e,t,a){if(0!=e%1||0>e)throw new RangeError('offset is not uint');if(e+t>a)throw new RangeError('Trying to access beyond buffer length')}function k(e,t,a,i,o,r){if(!n.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<r)throw new RangeError('"value" argument is out of bounds');if(a+i>e.length)throw new RangeError('Index out of range')}function O(e,t,a,n){if(a+n>e.length)throw new RangeError('Index out of range');if(0>a)throw new RangeError('Index out of range')}function z(e,t,a,n,i){return t=+t,a>>>=0,i||O(e,t,a,4,3.4028234663852886e38,-3.4028234663852886e38),v.write(e,t,a,n,23,4),a+4}function N(e,t,a,n,i){return t=+t,a>>>=0,i||O(e,t,a,8,1.7976931348623157e308,-1.7976931348623157e308),v.write(e,t,a,n,52,8),a+8}function X(e){if(e=e.split('=')[0],e=e.trim().replace(Q,''),2>e.length)return'';for(;0!=e.length%4;)e+='=';return e}function Y(e){return 16>e?'0'+e.toString(16):e.toString(16)}function H(e,t){t=t||Infinity;for(var a,n=e.length,o=null,r=[],s=0;s<n;++s){if(a=e.charCodeAt(s),55295<a&&57344>a){if(!o){if(56319<a){-1<(t-=3)&&r.push(239,191,189);continue}else if(s+1===n){-1<(t-=3)&&r.push(239,191,189);continue}o=a;continue}if(56320>a){-1<(t-=3)&&r.push(239,191,189),o=a;continue}a=(o-55296<<10|a-56320)+65536}else o&&-1<(t-=3)&&r.push(239,191,189);if(o=null,128>a){if(0>(t-=1))break;r.push(a)}else if(2048>a){if(0>(t-=2))break;r.push(192|a>>6,128|63&a)}else if(65536>a){if(0>(t-=3))break;r.push(224|a>>12,128|63&a>>6,128|63&a)}else if(1114112>a){if(0>(t-=4))break;r.push(240|a>>18,128|63&a>>12,128|63&a>>6,128|63&a)}else throw new Error('Invalid code point')}return r}function U(e){for(var t=[],a=0;a<e.length;++a)t.push(255&e.charCodeAt(a));return t}function W(e,t){for(var a,n,o,r=[],s=0;s<e.length&&!(0>(t-=2));++s)a=e.charCodeAt(s),n=a>>8,o=a%256,r.push(o),r.push(n);return r}function J(e){return E.toByteArray(X(e))}function j(e,t,a,n){for(var o=0;o<n&&!(o+a>=t.length||o>=e.length);++o)t[o+a]=e[o];return o}function V(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function q(e){return e!==e}t.Buffer=n,t.SlowBuffer=function(e){return+e!=e&&(e=0),n.alloc(+e)},t.INSPECT_MAX_BYTES=50;var Z=2147483647;t.kMaxLength=Z,n.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}(),n.TYPED_ARRAY_SUPPORT||'undefined'==typeof console||'function'!=typeof console.error||console.error('This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.'),Object.defineProperty(n.prototype,'parent',{enumerable:!0,get:function(){return n.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(n.prototype,'offset',{enumerable:!0,get:function(){return n.isBuffer(this)?this.byteOffset:void 0}}),'undefined'!=typeof Symbol&&null!=Symbol.species&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192,n.from=function(e,t,a){return i(e,t,a)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array,n.alloc=function(e,t,a){return r(e,t,a)},n.allocUnsafe=function(e){return s(e)},n.allocUnsafeSlow=function(e){return s(e)},n.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==n.prototype},n.compare=function(e,t){if(V(e,Uint8Array)&&(e=n.from(e,e.offset,e.byteLength)),V(t,Uint8Array)&&(t=n.from(t,t.offset,t.byteLength)),!n.isBuffer(e)||!n.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var a=e.length,o=t.length,r=0,i=I(a,o);r<i;++r)if(e[r]!==t[r]){a=e[r],o=t[r];break}return a<o?-1:o<a?1:0},n.isEncoding=function(e){switch((e+'').toLowerCase()){case'hex':case'utf8':case'utf-8':case'ascii':case'latin1':case'binary':case'base64':case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return!0;default:return!1;}},n.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return n.alloc(0);var a;if(t===void 0)for(t=0,a=0;a<e.length;++a)t+=e[a].length;var i=n.allocUnsafe(t),o=0;for(a=0;a<e.length;++a){var r=e[a];if(V(r,Uint8Array)&&(r=n.from(r)),!n.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(i,o),o+=r.length}return i},n.byteLength=u,n.prototype._isBuffer=!0,n.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError('Buffer size must be a multiple of 16-bits');for(var t=0;t<e;t+=2)c(this,t,t+1);return this},n.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError('Buffer size must be a multiple of 32-bits');for(var t=0;t<e;t+=4)c(this,t,t+3),c(this,t+1,t+2);return this},n.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError('Buffer size must be a multiple of 64-bits');for(var t=0;t<e;t+=8)c(this,t,t+7),c(this,t+1,t+6),c(this,t+2,t+5),c(this,t+3,t+4);return this},n.prototype.toString=function(){var e=this.length;return 0===e?'':0===arguments.length?B(this,0,e):f.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(e){if(!n.isBuffer(e))throw new TypeError('Argument must be a Buffer');return this===e||0===n.compare(this,e)},n.prototype.inspect=function(){var e='',a=t.INSPECT_MAX_BYTES;return e=this.toString('hex',0,a).replace(/(.{2})/g,'$1 ').trim(),this.length>a&&(e+=' ... '),'<Buffer '+e+'>'},n.prototype.compare=function(e,t,a,o,r){if(V(e,Uint8Array)&&(e=n.from(e,e.offset,e.byteLength)),!n.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===a&&(a=e?e.length:0),void 0===o&&(o=0),void 0===r&&(r=this.length),0>t||a>e.length||0>o||r>this.length)throw new RangeError('out of range index');if(o>=r&&t>=a)return 0;if(o>=r)return-1;if(t>=a)return 1;if(t>>>=0,a>>>=0,o>>>=0,r>>>=0,this===e)return 0;for(var s=r-o,d=a-t,l=I(s,d),h=this.slice(o,r),g=e.slice(t,a),p=0;p<l;++p)if(h[p]!==g[p]){s=h[p],d=g[p];break}return s<d?-1:d<s?1:0},n.prototype.includes=function(e,t,a){return-1!==this.indexOf(e,t,a)},n.prototype.indexOf=function(e,t,a){return m(this,e,t,a,!0)},n.prototype.lastIndexOf=function(e,t,a){return m(this,e,t,a,!1)},n.prototype.write=function(e,t,a,n){if(void 0===t)n='utf8',a=this.length,t=0;else if(void 0===a&&'string'==typeof t)n=t,a=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(a)?(a>>>=0,void 0===n&&(n='utf8')):(n=a,a=void 0);else throw new Error('Buffer.write(string, encoding, offset[, length]) is no longer supported');var i=this.length-t;if((void 0===a||a>i)&&(a=i),0<e.length&&(0>a||0>t)||t>this.length)throw new RangeError('Attempt to write outside buffer bounds');n||(n='utf8');for(var o=!1;;)switch(n){case'hex':return _(this,e,t,a);case'utf8':case'utf-8':return C(this,e,t,a);case'ascii':return D(this,e,t,a);case'latin1':case'binary':return S(this,e,t,a);case'base64':return P(this,e,t,a);case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return w(this,e,t,a);default:if(o)throw new TypeError('Unknown encoding: '+n);n=(''+n).toLowerCase(),o=!0;}},n.prototype.toJSON=function(){return{type:'Buffer',data:Array.prototype.slice.call(this._arr||this,0)}};var K=4096;n.prototype.slice=function(e,t){var a=this.length;e=~~e,t=void 0===t?a:~~t,0>e?(e+=a,0>e&&(e=0)):e>a&&(e=a),0>t?(t+=a,0>t&&(t=0)):t>a&&(t=a),t<e&&(t=e);var i=this.subarray(e,t);return i.__proto__=n.prototype,i},n.prototype.readUIntLE=function(e,t,a){e>>>=0,t>>>=0,a||L(e,t,this.length);for(var n=this[e],o=1,r=0;++r<t&&(o*=256);)n+=this[e+r]*o;return n},n.prototype.readUIntBE=function(e,t,a){e>>>=0,t>>>=0,a||L(e,t,this.length);for(var n=this[e+--t],i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},n.prototype.readUInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),this[e]},n.prototype.readUInt16LE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]|this[e+1]<<8},n.prototype.readUInt16BE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]<<8|this[e+1]},n.prototype.readUInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},n.prototype.readUInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},n.prototype.readIntLE=function(e,t,a){e>>>=0,t>>>=0,a||L(e,t,this.length);for(var n=this[e],o=1,r=0;++r<t&&(o*=256);)n+=this[e+r]*o;return o*=128,n>=o&&(n-=b(2,8*t)),n},n.prototype.readIntBE=function(e,t,a){e>>>=0,t>>>=0,a||L(e,t,this.length);for(var n=t,i=1,o=this[e+--n];0<n&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=b(2,8*t)),o},n.prototype.readInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},n.prototype.readInt16LE=function(e,t){e>>>=0,t||L(e,2,this.length);var a=this[e]|this[e+1]<<8;return 32768&a?4294901760|a:a},n.prototype.readInt16BE=function(e,t){e>>>=0,t||L(e,2,this.length);var a=this[e+1]|this[e]<<8;return 32768&a?4294901760|a:a},n.prototype.readInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},n.prototype.readInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},n.prototype.readFloatLE=function(e,t){return e>>>=0,t||L(e,4,this.length),v.read(this,e,!0,23,4)},n.prototype.readFloatBE=function(e,t){return e>>>=0,t||L(e,4,this.length),v.read(this,e,!1,23,4)},n.prototype.readDoubleLE=function(e,t){return e>>>=0,t||L(e,8,this.length),v.read(this,e,!0,52,8)},n.prototype.readDoubleBE=function(e,t){return e>>>=0,t||L(e,8,this.length),v.read(this,e,!1,52,8)},n.prototype.writeUIntLE=function(e,t,a,n){if(e=+e,t>>>=0,a>>>=0,!n){var o=b(2,8*a)-1;k(this,e,t,a,o,0)}var r=1,s=0;for(this[t]=255&e;++s<a&&(r*=256);)this[t+s]=255&e/r;return t+a},n.prototype.writeUIntBE=function(e,t,a,n){if(e=+e,t>>>=0,a>>>=0,!n){var o=b(2,8*a)-1;k(this,e,t,a,o,0)}var r=a-1,i=1;for(this[t+r]=255&e;0<=--r&&(i*=256);)this[t+r]=255&e/i;return t+a},n.prototype.writeUInt8=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,1,255,0),this[t]=255&e,t+1},n.prototype.writeUInt16LE=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},n.prototype.writeUInt16BE=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},n.prototype.writeUInt32LE=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},n.prototype.writeUInt32BE=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},n.prototype.writeIntLE=function(e,t,a,n){if(e=+e,t>>>=0,!n){var o=b(2,8*a-1);k(this,e,t,a,o-1,-o)}var r=0,i=1,s=0;for(this[t]=255&e;++r<a&&(i*=256);)0>e&&0==s&&0!==this[t+r-1]&&(s=1),this[t+r]=255&(e/i>>0)-s;return t+a},n.prototype.writeIntBE=function(e,t,a,n){if(e=+e,t>>>=0,!n){var o=b(2,8*a-1);k(this,e,t,a,o-1,-o)}var r=a-1,i=1,s=0;for(this[t+r]=255&e;0<=--r&&(i*=256);)0>e&&0==s&&0!==this[t+r+1]&&(s=1),this[t+r]=255&(e/i>>0)-s;return t+a},n.prototype.writeInt8=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,1,127,-128),0>e&&(e=255+e+1),this[t]=255&e,t+1},n.prototype.writeInt16LE=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},n.prototype.writeInt16BE=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},n.prototype.writeInt32LE=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},n.prototype.writeInt32BE=function(e,t,a){return e=+e,t>>>=0,a||k(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},n.prototype.writeFloatLE=function(e,t,a){return z(this,e,t,!0,a)},n.prototype.writeFloatBE=function(e,t,a){return z(this,e,t,!1,a)},n.prototype.writeDoubleLE=function(e,t,a){return N(this,e,t,!0,a)},n.prototype.writeDoubleBE=function(e,t,a){return N(this,e,t,!1,a)},n.prototype.copy=function(e,t,a,o){if(!n.isBuffer(e))throw new TypeError('argument should be a Buffer');if(a||(a=0),o||0===o||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),0<o&&o<a&&(o=a),o===a)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError('targetStart out of bounds');if(0>a||a>=this.length)throw new RangeError('Index out of range');if(0>o)throw new RangeError('sourceEnd out of bounds');o>this.length&&(o=this.length),e.length-t<o-a&&(o=e.length-t+a);var r=o-a;if(this===e&&'function'==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,a,o);else if(this===e&&a<t&&t<o)for(var s=r-1;0<=s;--s)e[s+t]=this[s+a];else Uint8Array.prototype.set.call(e,this.subarray(a,o),t);return r},n.prototype.fill=function(e,t,a,o){if('string'==typeof e){if('string'==typeof t?(o=t,t=0,a=this.length):'string'==typeof a&&(o=a,a=this.length),void 0!==o&&'string'!=typeof o)throw new TypeError('encoding must be a string');if('string'==typeof o&&!n.isEncoding(o))throw new TypeError('Unknown encoding: '+o);if(1===e.length){var r=e.charCodeAt(0);('utf8'===o&&128>r||'latin1'===o)&&(e=r)}}else'number'==typeof e&&(e&=255);if(0>t||this.length<t||this.length<a)throw new RangeError('Out of range index');if(a<=t)return this;t>>>=0,a=a===void 0?this.length:a>>>0,e||(e=0);var s;if('number'==typeof e)for(s=t;s<a;++s)this[s]=e;else{var i=n.isBuffer(e)?e:n.from(e,o),d=i.length;if(0===d)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<a-t;++s)this[s+t]=i[s%d]}return this};var Q=/[^+/0-9A-Za-z-_]/g});self.Buffer=G.Buffer;var A=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});var a;(function(e){e.Noise='noise'})(a=t.EffectType||(t.EffectType={}));var n;(function(e){e.JPEG='jpeg',e.PNG='png',e.NoTranscode='no-transcode'})(n=t.ImageFormat||(t.ImageFormat={}));var i;(function(e){e.Auto='auto',e.Contain='contain',e.Cover='cover',e.Exact='exact',e.Crop='crop'})(i=t.ImageResizeFit||(t.ImageResizeFit={}));var o;(function(e){e.NearestNeighbor='nearestNeighbor',e.Bilinear='bilinear',e.Bicubic='bicubic'})(o=t.ImageResizeMethod||(t.ImageResizeMethod={}));var r;(function(e){e.Sobel='sobel',e.Canny='canny'})(r=t.EdgeMethod||(t.EdgeMethod={}));var s;(function(e){e.PHash='phash',e.LumaHash='luma'})(s=t.HashMethod||(t.HashMethod={}));var d;(function(e){e.Red='r',e.Green='g',e.Blue='b',e.Alpha='a',e.Hue='h',e.Saturation='s',e.Lightness='l',e.Luminance255='Y-255',e.Luminance='Y',e.Chroma='c',e.ChromaBlue='cb',e.ChromaRed='cr',e.x='x-xyy',e.y='y-xyy',e.X='x-xyz',e.Y='y-xyz',e.Z='z-xyz'})(d=t.ColorChannel||(t.ColorChannel={}));var l;(function(e){e.HSL='hsl',e.HCL='hcl',e.YCbCr='ycbcr',e.XYZ='xyz',e.XYY='xyy',e.RGB='rgb',e.RGBA='rgba',e.Greyscale='k'})(l=t.Colorspace||(t.Colorspace={})),t.DEFAULT_FORMAT={type:n.JPEG,quality:90}});t(A);var L=a(function(e,t){function a(){return i?i:('undefined'!=typeof window&&(i=window),'undefined'!=typeof self&&(i=self),'undefined'!=typeof x&&(i=x),i)}function n(){return'undefined'!=typeof window&&'undefined'!=typeof navigator}Object.defineProperty(t,'__esModule',{value:!0});let i;t.hasWASM=function(){const e=a();return!!(e['@eris/image-wasm']&&e['@eris/image-wasm'].wasmModule)},t.isBrowser=n,t.isNode=function(){return!n()},t.getWASM=function(){return a()['@eris/image-wasm']}});t(L);var k=a(function(e,t){function a(){return'__canvas__'in self?self.__canvas__:document.createElement('canvas')}function n(e){return new Promise((t)=>{const a=new FileReader;a.addEventListener('loadend',()=>t(a.result)),e(a)})}Object.defineProperty(t,'__esModule',{value:!0}),t.decode=function(e){const t=a(),i=t.getContext('2d');return new Promise((a,o)=>{const r=new Image;r.addEventListener('error',o),r.addEventListener('load',()=>{try{t.width=r.width,t.height=r.height,i.drawImage(r,0,0);const e=i.getImageData(0,0,r.width,r.height);a({width:e.width,height:e.height,data:e.data})}catch(e){o(e)}}),'string'==typeof e?r.src=e:n((t)=>t.readAsDataURL(new Blob([e]))).then((e)=>{r.src=e}).catch(o)})},t.encode=function(e,t,i){const o=a(),r=o.getContext('2d');return o.width=e.width,o.height=e.height,r.putImageData(e,0,0),new Promise((e,a)=>{o.toBlob((t)=>{return t?void n((e)=>e.readAsArrayBuffer(t)).then((t)=>{e(new Uint8Array(t))}).catch(a):a(new Error('failed to convert canvas to blob'))},t,i)})}});t(k);var O=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.decode=function(e){return k.decode(e)},t.encode=function(e,t){return k.encode(e,'image/jpeg',t)}});t(O);var z=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});class a{static get sync(){return{read(e){return k.decode(e)},write(e){return k.encode(e,'image/png')}}}}t.PNG=a});t(z);var N=a(function(e){const t=(e)=>Array.from(e).map((e)=>e.charCodeAt(0)),a=t('META-INF/mozilla.rsa'),n=t('[Content_Types].xml'),i=t('_rels/.rels');e.exports=(e)=>{const o=e instanceof Uint8Array?e:new Uint8Array(e);if(!(o&&1<o.length))return null;const r=(e,t)=>{t=Object.assign({offset:0},t);for(let a=0;a<e.length;a++)if(t.mask){if(e[a]!==(t.mask[a]&o[a+t.offset]))return!1;}else if(e[a]!==o[a+t.offset])return!1;return!0},s=(e,a)=>r(t(e),a);if(r([255,216,255]))return{ext:'jpg',mime:'image/jpeg'};if(r([137,80,78,71,13,10,26,10]))return{ext:'png',mime:'image/png'};if(r([71,73,70]))return{ext:'gif',mime:'image/gif'};if(r([87,69,66,80],{offset:8}))return{ext:'webp',mime:'image/webp'};if(r([70,76,73,70]))return{ext:'flif',mime:'image/flif'};if((r([73,73,42,0])||r([77,77,0,42]))&&r([67,82],{offset:8}))return{ext:'cr2',mime:'image/x-canon-cr2'};if(r([73,73,42,0])||r([77,77,0,42]))return{ext:'tif',mime:'image/tiff'};if(r([66,77]))return{ext:'bmp',mime:'image/bmp'};if(r([73,73,188]))return{ext:'jxr',mime:'image/vnd.ms-photo'};if(r([56,66,80,83]))return{ext:'psd',mime:'image/vnd.adobe.photoshop'};if(r([80,75,3,4])){if(r([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:'epub',mime:'application/epub+zip'};if(r(a,{offset:30}))return{ext:'xpi',mime:'application/x-xpinstall'};if(s('mimetypeapplication/vnd.oasis.opendocument.text',{offset:30}))return{ext:'odt',mime:'application/vnd.oasis.opendocument.text'};if(s('mimetypeapplication/vnd.oasis.opendocument.spreadsheet',{offset:30}))return{ext:'ods',mime:'application/vnd.oasis.opendocument.spreadsheet'};if(s('mimetypeapplication/vnd.oasis.opendocument.presentation',{offset:30}))return{ext:'odp',mime:'application/vnd.oasis.opendocument.presentation'};if(r(n,{offset:30})||r(i,{offset:30})){const e=o.subarray(4,2004),t=(e)=>e.findIndex((e,t,a)=>80===a[t]&&75===a[t+1]&&3===a[t+2]&&4===a[t+3]),a=t(e);if(-1!==a){const e=o.subarray(a+8,a+8+1e3),n=t(e);if(-1!==n){const e=8+a+n+30;if(s('word/',{offset:e}))return{ext:'docx',mime:'application/vnd.openxmlformats-officedocument.wordprocessingml.document'};if(s('ppt/',{offset:e}))return{ext:'pptx',mime:'application/vnd.openxmlformats-officedocument.presentationml.presentation'};if(s('xl/',{offset:e}))return{ext:'xlsx',mime:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'}}}}}if(r([80,75])&&(3===o[2]||5===o[2]||7===o[2])&&(4===o[3]||6===o[3]||8===o[3]))return{ext:'zip',mime:'application/zip'};if(r([117,115,116,97,114],{offset:257}))return{ext:'tar',mime:'application/x-tar'};if(r([82,97,114,33,26,7])&&(0===o[6]||1===o[6]))return{ext:'rar',mime:'application/x-rar-compressed'};if(r([31,139,8]))return{ext:'gz',mime:'application/gzip'};if(r([66,90,104]))return{ext:'bz2',mime:'application/x-bzip2'};if(r([55,122,188,175,39,28]))return{ext:'7z',mime:'application/x-7z-compressed'};if(r([120,1]))return{ext:'dmg',mime:'application/x-apple-diskimage'};if(r([51,103,112,53])||r([0,0,0])&&r([102,116,121,112],{offset:4})&&(r([109,112,52,49],{offset:8})||r([109,112,52,50],{offset:8})||r([105,115,111,109],{offset:8})||r([105,115,111,50],{offset:8})||r([109,109,112,52],{offset:8})||r([77,52,86],{offset:8})||r([100,97,115,104],{offset:8})))return{ext:'mp4',mime:'video/mp4'};if(r([77,84,104,100]))return{ext:'mid',mime:'audio/midi'};if(r([26,69,223,163])){const e=o.subarray(4,4100),t=e.findIndex((e,t,a)=>66===a[t]&&130===a[t+1]);if(-1!==t){const a=(a)=>Array.from(a).every((a,n)=>e[t+3+n]===a.charCodeAt(0));if(a('matroska'))return{ext:'mkv',mime:'video/x-matroska'};if(a('webm'))return{ext:'webm',mime:'video/webm'}}}if(r([0,0,0,20,102,116,121,112,113,116,32,32])||r([102,114,101,101],{offset:4})||r([102,116,121,112,113,116,32,32],{offset:4})||r([109,100,97,116],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:'mov',mime:'video/quicktime'};if(r([82,73,70,70])&&r([65,86,73],{offset:8}))return{ext:'avi',mime:'video/x-msvideo'};if(r([48,38,178,117,142,102,207,17,166,217]))return{ext:'wmv',mime:'video/x-ms-wmv'};if(r([0,0,1,186])||r([0,0,1,179]))return{ext:'mpg',mime:'video/mpeg'};if(r([102,116,121,112,51,103],{offset:4}))return{ext:'3gp',mime:'video/3gpp'};for(let t=0;2>t&&t<o.length-16;t++){if(r([73,68,51],{offset:t})||r([255,226],{offset:t,mask:[255,226]}))return{ext:'mp3',mime:'audio/mpeg'};if(r([255,228],{offset:t,mask:[255,228]}))return{ext:'mp2',mime:'audio/mpeg'}}if(r([102,116,121,112,77,52,65],{offset:4})||r([77,52,65,32]))return{ext:'m4a',mime:'audio/m4a'};if(r([79,112,117,115,72,101,97,100],{offset:28}))return{ext:'opus',mime:'audio/opus'};if(r([79,103,103,83]))return r([128,116,104,101,111,114,97],{offset:28})?{ext:'ogv',mime:'video/ogg'}:r([1,118,105,100,101,111,0],{offset:28})?{ext:'ogm',mime:'video/ogg'}:r([127,70,76,65,67],{offset:28})?{ext:'oga',mime:'audio/ogg'}:r([83,112,101,101,120,32,32],{offset:28})?{ext:'spx',mime:'audio/ogg'}:r([1,118,111,114,98,105,115],{offset:28})?{ext:'ogg',mime:'audio/ogg'}:{ext:'ogx',mime:'application/ogg'};if(r([102,76,97,67]))return{ext:'flac',mime:'audio/x-flac'};if(r([82,73,70,70])&&r([87,65,86,69],{offset:8}))return{ext:'wav',mime:'audio/x-wav'};if(r([35,33,65,77,82,10]))return{ext:'amr',mime:'audio/amr'};if(r([37,80,68,70]))return{ext:'pdf',mime:'application/pdf'};if(r([77,90]))return{ext:'exe',mime:'application/x-msdownload'};if((67===o[0]||70===o[0])&&r([87,83],{offset:1}))return{ext:'swf',mime:'application/x-shockwave-flash'};if(r([123,92,114,116,102]))return{ext:'rtf',mime:'application/rtf'};if(r([0,97,115,109]))return{ext:'wasm',mime:'application/wasm'};if(r([119,79,70,70])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:'woff',mime:'font/woff'};if(r([119,79,70,50])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:'woff2',mime:'font/woff2'};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:'eot',mime:'application/octet-stream'};if(r([0,1,0,0,0]))return{ext:'ttf',mime:'font/ttf'};if(r([79,84,84,79,0]))return{ext:'otf',mime:'font/otf'};if(r([0,0,1,0]))return{ext:'ico',mime:'image/x-icon'};if(r([0,0,2,0]))return{ext:'cur',mime:'image/x-icon'};if(r([70,76,86,1]))return{ext:'flv',mime:'video/x-flv'};if(r([37,33]))return{ext:'ps',mime:'application/postscript'};if(r([253,55,122,88,90,0]))return{ext:'xz',mime:'application/x-xz'};if(r([83,81,76,105]))return{ext:'sqlite',mime:'application/x-sqlite3'};if(r([78,69,83,26]))return{ext:'nes',mime:'application/x-nintendo-nes-rom'};if(r([67,114,50,52]))return{ext:'crx',mime:'application/x-google-chrome-extension'};if(r([77,83,67,70])||r([73,83,99,40]))return{ext:'cab',mime:'application/vnd.ms-cab-compressed'};if(r([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:'deb',mime:'application/x-deb'};if(r([33,60,97,114,99,104,62]))return{ext:'ar',mime:'application/x-unix-archive'};if(r([237,171,238,219]))return{ext:'rpm',mime:'application/x-rpm'};if(r([31,160])||r([31,157]))return{ext:'Z',mime:'application/x-compress'};if(r([76,90,73,80]))return{ext:'lz',mime:'application/x-lzip'};if(r([208,207,17,224,161,177,26,225]))return{ext:'msi',mime:'application/x-msi'};if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:'mxf',mime:'application/mxf'};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:'mts',mime:'video/mp2t'};if(r([66,76,69,78,68,69,82]))return{ext:'blend',mime:'application/x-blender'};if(r([66,80,71,251]))return{ext:'bpg',mime:'image/bpg'};if(r([0,0,0,12,106,80,32,32,13,10,135,10])){if(r([106,112,50,32],{offset:20}))return{ext:'jp2',mime:'image/jp2'};if(r([106,112,120,32],{offset:20}))return{ext:'jpx',mime:'image/jpx'};if(r([106,112,109,32],{offset:20}))return{ext:'jpm',mime:'image/jpm'};if(r([109,106,112,50],{offset:20}))return{ext:'mj2',mime:'image/mj2'}}if(r([70,79,82,77,0]))return{ext:'aif',mime:'audio/aiff'};if(s('<?xml '))return{ext:'xml',mime:'application/xml'};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:'mobi',mime:'application/x-mobipocket-ebook'};if(r([102,116,121,112],{offset:4})){if(r([109,105,102,49],{offset:8}))return{ext:'heic',mime:'image/heif'};if(r([109,115,102,49],{offset:8}))return{ext:'heic',mime:'image/heif-sequence'};if(r([104,101,105,99],{offset:8})||r([104,101,105,120],{offset:8}))return{ext:'heic',mime:'image/heic'};if(r([104,101,118,99],{offset:8})||r([104,101,118,120],{offset:8}))return{ext:'heic',mime:'image/heic-sequence'}}return null}}),X=a(function(e,t){var a=Math.sin;Object.defineProperty(t,'__esModule',{value:!0});const n=z.PNG;t.defaultCalibrationProfile={xRed:0.4124,yRed:0.2126,zRed:0.0193,xGreen:0.3576,yGreen:0.7152,zGreen:0.1192,xBlue:0.1805,yBlue:0.0722,zBlue:0.9505};var i;(function(e){e.Linear='linear'})(i=t.ProximitySmoothingMethod||(t.ProximitySmoothingMethod={}));class o{static probablyIs(e){return e&&e.data&&'number'==typeof e.width&&'number'==typeof e.height&&0==e.data.length%e.width*e.height}static is(e){return o.probablyIs(e)&&'number'==typeof e.channels&&(e.colorspace===A.Colorspace.RGB||e.colorspace===A.Colorspace.RGBA||e.colorspace===A.Colorspace.Greyscale||e.colorspace===A.Colorspace.HSL||e.colorspace===A.Colorspace.HCL||e.colorspace===A.Colorspace.YCbCr||e.colorspace===A.Colorspace.XYY||e.colorspace===A.Colorspace.XYZ)&&e.data.length===e.width*e.height*e.channels}static normalize(e){const t=e.data.length/(e.width*e.height);let a;return a=3==t?A.Colorspace.RGB:1==t?A.Colorspace.Greyscale:A.Colorspace.RGBA,Object.assign({channels:t,colorspace:a},e)}static assert(e,t){if(!o.is(e))throw new TypeError('Unexpected image data');if(t&&-1===t.indexOf(e.colorspace)){const a=t.join(' or '),n=e.colorspace;throw new TypeError(`Expected ${a} colorspace but found ${n}`)}return e}static getChannelRange(e){switch(e){case A.ColorChannel.Red:case A.ColorChannel.Green:case A.ColorChannel.Blue:case A.ColorChannel.Alpha:case A.ColorChannel.Luminance255:case A.ColorChannel.ChromaRed:case A.ColorChannel.ChromaBlue:return 255;case A.ColorChannel.Hue:return 360;case A.ColorChannel.Saturation:case A.ColorChannel.Luminance:case A.ColorChannel.Lightness:case A.ColorChannel.Chroma:case A.ColorChannel.X:case A.ColorChannel.Y:case A.ColorChannel.Z:case A.ColorChannel.x:case A.ColorChannel.y:return 1;default:throw new Error(`Unknown channel ${e}`);}}static clipChannel(e,t=A.ColorChannel.Red){switch(t){case A.ColorChannel.Hue:let a=_(e);for(;0>a;)a+=360;return a%360;default:const n=o.getChannelRange(t),i=1===n?e:_(e);return 0>i?0:i>n?n:i;}}static clip255(e){const t=_(e);return 0>t?0:255<t?255:t}static clipX(e,t){return 0>e?0:e>=t.width?t.width-1:e}static clipY(e,t){return 0>e?0:e>=t.height?t.height-1:e}static isBorder(e,t,a,n=1){return 0>t-n||0>a-n||t+n>=e.width||a+n>=e.height}static indexFor(e,t,a,n=0){const i=e.width-1,o=e.height-1;return t=0>t?0:t>i?i:t,a=0>a?0:a>o?o:a,(a*e.width+t)*e.channels+n}static pixelFor(e,t,a){const{colorspace:n,data:i,channels:r}=e,s=o.indexFor(e,t,a),d=[...i.slice(s,s+r)];return{x:t,y:a,index:s,values:d,colorspace:n}}static valueFor(e,t,a,n=0){return e.data[o.indexFor(e,t,a,n)]}static channelsFor(e){const{Hue:t,Saturation:a,Lightness:n,Red:i,Green:o,Blue:r,Alpha:s,Luminance255:d,Luminance:l,Chroma:h,ChromaBlue:g,ChromaRed:p,x:u,y:f,X:c,Y:m,Z:y}=A.ColorChannel;return e===A.Colorspace.Greyscale?[d]:e===A.Colorspace.HSL?[t,a,n]:e===A.Colorspace.HCL?[t,h,l]:e===A.Colorspace.YCbCr?[d,g,p]:e===A.Colorspace.XYZ?[c,m,y]:e===A.Colorspace.XYY?[u,f,m]:[i,o,r,s]}static channelFor(e,t){return o.channelsFor(e.colorspace)[t]}static getOffsetForAngle(e){switch(e){case 0:return{x:1,y:0};case 45:return{x:-1,y:1};case 90:return{x:0,y:1};case 135:return{x:1,y:1};default:throw new Error(`invalid angle: ${e}`);}}static getPixelsForAngle(e,t,a,n,r=1){const s=o.getOffsetForAngle(n),d=[];for(let l=-r;l<=r;l++){if(0===l)continue;const n=t+s.x*l,i=a+s.y*l,r=o.indexFor(e,n,i);d.push({x:n,y:i,index:r,colorspace:A.Colorspace.Greyscale,values:[e.data[r]]})}return d}static rotateSquareArray(e,t,n,i,r,s=1){if(n!==i)throw new Error('Only works on squares');const d={width:n,height:i,channels:s},l=c((360-r)*m/180),h=a((360-r)*m/180),g=(n-1)/2,p=(i-1)/2;for(let a=0;a<i;a++)for(let i=0;i<n;i++){const n=i-g,r=a-p,u=_(n*l-r*h+g),f=_(n*h+r*l+p);if(o.isBorder(d,u,f,0))continue;const c=o.indexFor(d,i,a),m=o.indexFor(d,u,f);for(let a=0;a<s;a++){const n=e[c+a];t[m+a]=n}}}static rotate(e,t){const a=Object.assign({},e),n=e.width*e.height,i=new Uint8Array(n*e.channels);if(e.width===e.height)o.rotateSquareArray(e.data,i,e.width,e.height,t,e.channels);else{if(0!=t%90)throw new Error('Can only rotate by 90 degree increments');(90===t||270===t)&&(a.width=e.height,a.height=e.width);for(let n=0;n<e.width;n++)for(let r=0;r<e.height;r++){let s,d;90===t?(s=r,d=e.width-n-1):180===t?(s=e.width-n-1,d=e.height-r-1):270===t&&(s=e.height-r-1,d=n);const l=o.indexFor(e,n,r),h=o.indexFor(a,s,d);for(let t=0;t<e.channels;t++)i[h+t]=e.data[l+t]}}return a.data=i,a}static proximityTransform(e,t){function a({filterChannels:t,filterChannelCenters:a,filterChannelRanges:n},o){const r=[];let d=0;for(let l=0;l<s.length;l++){const i=s[l],h=t.indexOf(i);if(-1===h)continue;const g=e.data[o+l];let p=D(a[h]-g);i===A.ColorChannel.Hue&&(p%=360,p=I(p,360-p)),p/=n[h],p=I(p,1),r.push(p),d+=p}return 0.05>r.length-d?[]:r}function n(e){let t=0;if(1===e.length)t=c(e[0]*m/2);else{let a=0;for(const t of e)a+=t*t;t=1<a?0:1-f(a)}return t}function r({targetChannel:t,targetIntensity:a},n,r){for(let d=0;d<s.length;d++){if(s[d]!==t)continue;const i=e.data[n+d];e.data[n+d]=o.clipChannel(i+r*a,t)}}const s=o.channelsFor(e.colorspace);for(let i=0;i<e.width;i++)for(let s=0;s<e.height;s++){const d=o.indexFor(e,i,s);for(let e=0;e<t.length;e++){const i=t[e],o=a(i,d);if(!o.length)continue;const s=n(o);r(i,d,s)}}return e}static mapPixels(e,t){if(Array.isArray(t)||(t=[t]),0===t.length)return e;const a=o.channelsFor(e.colorspace),n=0<=[A.Colorspace.RGBA,A.Colorspace.RGB,A.Colorspace.Greyscale,A.Colorspace.YCbCr].indexOf(e.colorspace),{width:i,height:r}=e,s=n?new Uint8Array(e.width*e.height*e.channels):[],d=Object.assign({},e,{width:i,height:r,data:s});for(let n=0;n<r;n++)for(let r=0;r<i;r++){const d=o.pixelFor(e,r,n);for(const e of t)d.values=e(d);for(let t=0;t<e.channels;t++)s[d.index+t]=o.clipChannel(d.values[t],a[t])}return d}static toGreyscale(e){if(o.assert(e),e.colorspace===A.Colorspace.Greyscale)return e;e=o.toRGBA(e);const t=Object.assign({},e),a=e.width*e.height,n=new Uint8Array(a);for(let t=0;t<a;t++){const a=e.data[t*e.channels+0],i=e.data[t*e.channels+1],o=e.data[t*e.channels+2];n[t]=_(0.3*a+0.59*i+0.11*o)}return t.colorspace=A.Colorspace.Greyscale,t.channels=1,t.data=n,t}static toHSL(e){if(o.assert(e),e.colorspace===o.HSL)return e;e=o.toRGB(e);const t=Object.assign({},e),a=e.width*e.height,n=new Float32Array(3*a);for(let t=0;t<a;t++){const a=3*t,i=e.data[a]/255,r=e.data[a+1]/255,s=e.data[a+2]/255,d=I(i,r,s),l=u(i,r,s),h=l-d,g=(l+d)/2;let p=0,f=0;h&&(f=h/(1-D(2*g-1)),p=l===i?(360+60*(r-s)/h)%360:l===r?60*((s-i)/h+2):60*((i-r)/h+4)),n[a+0]=o.clipChannel(p,A.ColorChannel.Hue),n[a+1]=o.clipChannel(f,A.ColorChannel.Saturation),n[a+2]=o.clipChannel(g,A.ColorChannel.Lightness)}return t.colorspace=o.HSL,t.channels=3,t.data=n,t}static _HSLToRGB(e){const t=Object.assign({},e),a=e.width*e.height,n=new Uint8Array(3*a);for(let t=0;t<a;t++){const a=3*t,i=e.data[a],d=e.data[a+1],s=e.data[a+2],l=s-d*(1-D(2*s-1))/2,h=2*s-l,p=h-l;let u=0,r=0,g=0;60>=i?(u=h,r=i*p/60+l,g=l):120>=i?(u=-((i-120)*p)/60+l,r=h,g=l):180>=i?(u=l,r=h,g=(i-120)*p/60+l):240>=i?(u=l,r=-((i-240)*p)/60+l,g=h):300>=i?(u=(i-240)*p/60+l,r=l,g=h):(u=h,r=l,g=-((i-360)*p)/60+l),n[a+0]=o.clip255(255*u),n[a+1]=o.clip255(255*r),n[a+2]=o.clip255(255*g)}return t.colorspace=A.Colorspace.RGB,t.channels=3,t.data=n,t}static toHCL(e){if(o.assert(e),e.colorspace===A.Colorspace.HCL)return e;e=o.toXYY(e);const t=Object.assign({},e),a=e.width*e.height,n=[];for(let t=0;t<a;t++){const a=3*t,i=e.data[a],o=e.data[a+1],r=e.data[a+2],s=i-0.3127,d=o-0.329,l=f(s*s+d*d);let h=180*Math.atan(d/s)/m;0>s&&0<d&&(h+=180),0>s&&0>d&&(h+=180),0<s&&0>d&&(h+=360),n[a+0]=h,n[a+1]=l,n[a+2]=r}return t.colorspace=A.Colorspace.HCL,t.channels=3,t.data=n,t}static _HCLToXYY(e){const t=Object.assign({},e),n=e.width*e.height,o=[];for(let t=0;t<n;t++){const n=3*t,i=e.data[n],r=e.data[n+1],s=e.data[n+2],d=c(i*m/180)*r,l=a(i*m/180)*r;o[n+0]=d+0.3127,o[n+1]=l+0.329,o[n+2]=s}return t.colorspace=A.Colorspace.XYY,t.channels=3,t.data=o,t}static toXYZ(e,a=t.defaultCalibrationProfile){if(o.assert(e),e.colorspace===A.Colorspace.YCbCr)return e;e=o.toRGB(e);const n=Object.assign({},e),r=e.width*e.height;if(L.hasWASM()&&10<Math.random()){const{wasmModule:t}=L.getWASM(),i=3*r,o=4*i,s=t.instance.exports.alloc(o),d=new Float32Array(t.instance.exports.memory.buffer,s,i);for(let t=0;t<e.data.length;t++)d[t]=e.data[t];t.instance.exports.toXYZ(s,r,a.xRed,a.xGreen,a.xBlue,a.yRed,a.yGreen,a.yBlue,a.zRed,a.zGreen,a.zBlue),n.data=[...d],t.instance.exports.dealloc(s,o)}else{const t=(e)=>{return 0.2>=e?e*e:0.6>=e?e*e-0.125*e+0.025:e*e+0.125*e-0.125},o=[];for(let n=0;n<r;n++){const i=3*n,r=t(e.data[i]/255),s=t(e.data[i+1]/255),d=t(e.data[i+2]/255),l=a.xRed*r+a.xGreen*s+a.xBlue*d,h=a.yRed*r+a.yGreen*s+a.yBlue*d,g=a.zRed*r+a.zGreen*s+a.zBlue*d;o[i+0]=l,o[i+1]=h,o[i+2]=g}n.data=o}return n.colorspace=A.Colorspace.XYZ,n.channels=3,n}static _XYZToRGB(e){const t=Object.assign({},e),a=e.width*e.height;if(L.hasWASM()){const{wasmModule:n}=L.getWASM(),i=3*a,o=4*i,r=n.instance.exports.alloc(o),s=n.instance.exports.alloc(i),d=new Float32Array(n.instance.exports.memory.buffer,r,i),l=new Uint8Array(n.instance.exports.memory.buffer,s,i);for(let t=0;t<e.data.length;t++)d[t]=e.data[t];n.instance.exports.toRGBFromXYZ(r,s,a),t.data=new Uint8Array(l),n.instance.exports.dealloc(r,o),n.instance.exports.dealloc(s,o)}else{const n=new Uint8Array(3*a),r=(e)=>{return 0.04>=e?f(e):0.31>=e?(f(6400*e-135)+5)/80:(f(256*e+33)-1)/16};for(let t=0;t<a;t++){const a=3*t,i=e.data[a],s=e.data[a+1],d=e.data[a+2];n[a+0]=o.clip255(255*r(3.2406*i-1.5372*s-0.4986*d)),n[a+1]=o.clip255(255*r(-0.9689*i+1.8758*s+0.0415*d)),n[a+2]=o.clip255(255*r(0.0557*i-0.204*s+1.057*d))}t.data=n}return t.colorspace=A.Colorspace.RGB,t.channels=3,t}static toXYY(e){const t=Object.assign({},o.toXYZ(e));t.data=t.data.slice();const a=e.width*e.height;for(let n=0;n<a;n++){const e=3*n,a=t.data[e+0],i=t.data[e+1],o=t.data[e+2],r=a+i+o;t.data[e+0]=a/r,t.data[e+1]=i/r,t.data[e+2]=i}return t.colorspace=A.Colorspace.XYY,t}static _XYYToRGB(e){const t=Object.assign({},e);t.data=t.data.slice();const a=e.width*e.height;for(let n=0;n<a;n++){const e=3*n,a=t.data[e+0],i=t.data[e+1],o=t.data[e+2],r=o/i,s=a*r;t.data[e+0]=s,t.data[e+1]=o,t.data[e+2]=r-o-s}return t.colorspace=A.Colorspace.XYZ,o._XYZToRGB(t)}static toYCbCr(e){if(o.assert(e),e.colorspace===A.Colorspace.YCbCr)return e;e=o.toRGB(e);const t=Object.assign({},e),a=e.width*e.height;if(L.hasWASM()){const{wasmModule:n}=L.getWASM(),i=3*a,o=i,r=n.instance.exports.alloc(o),s=new Uint8Array(n.instance.exports.memory.buffer,r,i);for(let t=0;t<e.height*e.width*e.channels;t++)s[t]=e.data[t];n.instance.exports.toYCbCr(r,a),t.data=new Uint8Array(s),n.instance.exports.dealloc(r,o)}else{const n=new Uint8Array(3*a);for(let t=0;t<a;t++){const a=3*t,i=e.data[a],r=e.data[a+1],s=e.data[a+2];n[a+0]=o.clip255(0+0.299*i+0.587*r+0.114*s),n[a+1]=o.clip255(128-0.169*i-0.331*r+0.501*s),n[a+2]=o.clip255(128+0.501*i-0.419*r-0.081*s)}t.data=n}return t.colorspace=A.Colorspace.YCbCr,t.channels=3,t}static _YCbCrToRGB(e){const t=Object.assign({},e),a=e.width*e.height,n=new Uint8Array(3*a);for(let t=0;t<a;t++){const a=3*t,i=e.data[a],r=e.data[a+1],s=e.data[a+2];n[a+0]=o.clip255(i+1.402*(s-128)),n[a+1]=o.clip255(i-0.344*(r-128)-0.714*(s-128)),n[a+2]=o.clip255(i+1.772*(r-128))}return t.colorspace=A.Colorspace.RGB,t.channels=3,t.data=n,t}static toRGB(e){if(o.assert(e),e.colorspace===A.Colorspace.RGB)return e;if(e.colorspace===A.Colorspace.RGBA)return o.removeAlphaChannel(e);if(e.colorspace===o.HSL)return o._HSLToRGB(e);if(e.colorspace===A.Colorspace.HCL)return o._XYYToRGB(o._HCLToXYY(e));if(e.colorspace===A.Colorspace.YCbCr)return o._YCbCrToRGB(e);if(e.colorspace===A.Colorspace.XYZ)return o._XYZToRGB(e);if(e.colorspace===A.Colorspace.XYY)return o._XYYToRGB(e);if(e.colorspace!==A.Colorspace.Greyscale)throw new Error('Image data was not greyscale');const t=Object.assign({},e),a=e.width*e.height,n=new Uint8Array(3*a);for(let t=0;t<a;t++){const a=3*t;n[a+0]=e.data[t],n[a+1]=e.data[t],n[a+2]=e.data[t]}return t.colorspace=A.Colorspace.RGB,t.channels=3,t.data=n,t}static toRGBA(e){if(o.assert(e),e.colorspace===A.Colorspace.RGBA)return e;e=o.toRGB(e);const t=Object.assign({},e),a=e.width*e.height,n=new Uint8Array(4*a);for(let t=0;t<a;t++){const a=3*t,i=4*t;n[i+0]=e.data[a+0],n[i+1]=e.data[a+1],n[i+2]=e.data[a+2],n[i+3]=255}return t.colorspace=A.Colorspace.RGBA,t.channels=4,t.data=n,t}static toColorspace(e,t){switch(t){case A.Colorspace.Greyscale:return o.toGreyscale(e);case A.Colorspace.HSL:return o.toHSL(e);case A.Colorspace.YCbCr:return o.toYCbCr(e);case A.Colorspace.RGB:return o.toRGB(e);case A.Colorspace.RGBA:return o.toRGBA(e);default:throw new Error(`Unrecognized colorspace '${t}'`);}}static removeAlphaChannel(e){if(o.assert(e),e.colorspace!==A.Colorspace.RGBA)return e;const t=Object.assign({},e),a=e.width*e.height,n=new Uint8Array(3*a);for(let t=0;t<a;t++){const a=4*t,i=3*t;n[i+0]=e.data[a+0],n[i+1]=e.data[a+1],n[i+2]=e.data[a+2]}return t.colorspace=A.Colorspace.RGB,t.channels=3,t.data=n,t}static from(e){const t=N(e)||{mime:'unknown'};let a;switch(t.mime){case'image/jpeg':a=O.decode(e,!0);break;case'image/png':a=n.sync.read(e);break;default:return Promise.reject(new TypeError(`Unrecognized mime type: ${t.mime}`));}return Promise.resolve(a).then(o.normalize)}static toBuffer(e,t){const a=t&&t.type||A.ImageFormat.JPEG;let i;switch(a){case A.ImageFormat.JPEG:case A.ImageFormat.NoTranscode:const r=t&&t.quality||90;i=O.encode(o.toRGBA(e),r).data;break;case A.ImageFormat.PNG:i=n.sync.write(o.toRGBA(e));break;default:return Promise.reject(new TypeError(`Unrecognized output type: ${a}`));}return Promise.resolve(i)}static toBrowserImageData(e){if('object'!=typeof window||'function'!=typeof window.ImageData)throw new Error('toBrowserImageData must be called in browser context');e=o.toRGBA(e);const t=new Uint8ClampedArray(e.data);return new window.ImageData(t,e.width,e.height)}}o.GREYSCALE=A.Colorspace.Greyscale,o.RGB=A.Colorspace.RGB,o.RGBA=A.Colorspace.RGBA,o.HSL=A.Colorspace.HSL,o.YCBCR=A.Colorspace.YCbCr,t.ImageData=o});t(X);var Y=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.writeFile=function(){throw new Error('unimplemented')}});t(Y);var H=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.writeFileAsync=function(e,t){return new Promise((a,n)=>{Y.writeFile(e,Buffer.from(t),(e)=>{e?n(e):a()})})}});t(H);var U=a(function(e,t){function a(e,t){const a=180*Math.atan2(t,e)/m;return(45*_(a/45)+180)%180}function n(e){let t=0;for(let a=0;a<e.length;a++)t+=u(e[a],0);return t}function i(e,t){let a=0,n=[];for(let i=-e;i<=e;i++)for(let t=-e;t<=e;t++){if(0===i)n[a]=0;else{const o=D(t)+D(i)-1,r=b(2,2*e-1-o);n[a]=-1*Math.sign(i)*r}a++}if(t){const t=2*e+1,a=Array(n.length);X.ImageData.rotateSquareArray(n,a,t,t,90),n=a}return n}Object.defineProperty(t,'__esModule',{value:!0}),t.generateWeightMatrix=i,t.sobel=function(e,t){const o=t&&t.radius||1,r=i(o,!0),s=i(o,!1),d=n(r),l=X.ImageData.toGreyscale(e),h=l.data,g=new Uint8Array(h.length),p=new Uint8Array(h.length),u=l.width,c=l.height,m=2*o+1,I=C(m/2);for(var b=0,D=0;D<c;D++)for(var y=0;y<u;y++){var x=0,S=0;if(X.ImageData.isBorder(l,y,D,I)){g[b]=0,p[b]=0,b++;continue}for(var P=0;P<m;P++)for(var w=0;w<m;w++){const e=y+w-I,t=D+P-I,a=t*u+e,n=P*m+w,i=r[n],o=s[n];x+=h[a]*i/d,S+=h[a]*o/d}g[b]=_(f(x*x+S*S)),p[b]=a(x,S),b++}return Object.assign({},l,{data:g,angles:p})}});t(U);var W=a(function(e,t){function a(e,t){if(!t.width||!t.height)throw new Error('Missing width or height');X.ImageData.assert(e,[A.Colorspace.RGBA,A.Colorspace.RGB,A.Colorspace.Greyscale]);const a=t.width,n=t.height,o=e.width/a,r=e.height/n;if(1>o||1>r)throw new Error('Box resize can only shrink images');else if(C(o)!==o||C(r)!==r)throw new Error('Can only box resize in integer increments');const s=new Uint8Array(a*n*e.channels);for(var d=0;d<a;d++)for(var i=0;i<n;i++)for(var l,h=C(d*o),g=C(i*r),p=(i*a+d)*e.channels,u=0;u<e.channels;u++){l=0;for(var f=0;f<o;f++)for(var c,m=0;m<r;m++)c=((g+m)*e.width+(h+f))*e.channels,l+=e.data[c+u];s[p+u]=l/(o*r)}return{width:a,height:n,data:s,channels:e.channels,colorspace:e.colorspace}}Object.defineProperty(t,'__esModule',{value:!0}),t.normalizeOptions=function(e,t){const a=e.width,n=e.height,i=a/n;let o=t.width,r=t.height;const s=o/r;let d=t.subselect;switch(d||(d={top:0,bottom:n,left:0,right:a}),t.fit){case A.ImageResizeFit.Auto:case A.ImageResizeFit.Exact:!o&&r?o=r*i:o&&!r&&(r=o/i);break;case A.ImageResizeFit.Contain:i>s?r=o/i:o=r*i;break;case A.ImageResizeFit.Cover:i>s?o=r*i:r=o/i;break;case A.ImageResizeFit.Crop:if(t.subselect){o=t.subselect.right-t.subselect.left,r=t.subselect.bottom-t.subselect.top;break}let e=a,l=n;i>s?e=n*s:l=a/s;const h=(n-l)/2,g=(a-e)/2;d={top:C(h),bottom:n-p(h),left:C(g),right:a-p(g)};}if(!o||!r)throw new Error('Invalid dimensions for resize');return Object.assign({fit:A.ImageResizeFit.Exact,method:A.ImageResizeMethod.Bilinear,doNotEnlarge:!!t.doNotEnlarge},t,{width:_(o),height:_(r),subselect:d})},t.nearestNeighbor=function(e,t){if(!t.width||!t.height)throw new Error('Missing width or height');X.ImageData.assert(e,[A.Colorspace.RGBA,A.Colorspace.RGB,A.Colorspace.Greyscale]);const a=t.width,n=t.height,o=e.width/a,r=e.height/n,s=new Uint8Array(a*n*e.channels);for(var d=0;d<a;d++)for(var i=0;i<n;i++){const t=C(d*o),n=C(i*r),g=(n*e.width+t)*e.channels;for(var l=(i*a+d)*e.channels,h=0;h<e.channels;h++)s[l+h]=e.data[g+h]}return{width:a,height:n,data:s,channels:e.channels,colorspace:e.colorspace}},t.bilinear=function(e,t){if(!t.width||!t.height)throw new Error('Missing width or height');X.ImageData.assert(e,[A.Colorspace.RGBA,A.Colorspace.RGB,A.Colorspace.Greyscale]);var n=t.width,o=t.height,r=e.width/n,s=e.height/o,d=null,l=null;if(2<=r||2<=s){const i=u(C(r),1),h=u(C(s),1);if(r===i&&s===h)return a(e,t);n*=i,o*=h,r=e.width/n,s=e.height/o,l=t,d={width:n,height:o,data:e.data,channels:e.channels,colorspace:e.colorspace}}for(var h=new Uint8Array(n*o*e.channels),g=0;g<n;g++)for(var i=0;i<o;i++){var p=g*r,f=i*s,c=C(p),m=C(f),y=c,x=C(f)*e.width,I=(x+y)*e.channels,b=I+e.channels,D=(x+e.width+y)*e.channels,S=D+e.channels;c===e.width-1&&(b=I,S=D),m===e.height-1&&(D=I,S=b);for(var P,w=1-(p-c),F=1-(f-m),B=w*F,M=(1-w)*F,R=w*(1-F),T=(1-w)*(1-F),E=B+M+R+T,v=(i*n+g)*e.channels,G=0;G<e.channels;G++)P=e.data[I+G]*B/E+e.data[b+G]*M/E+e.data[D+G]*R/E+e.data[S+G]*T/E,h[v+G]=_(P)}return d&&l&&(d.data=h,n=l.width,o=l.height,h=a(d,l).data),{width:n,height:o,data:h,channels:e.channels,colorspace:e.colorspace}},t.box=a});t(W);var J=a(function(e,t){function a(e,t,a){const n=[];for(let o=0;256>o;o++)n[o]=0;const o=e.width*e.height;for(let r=0;r<o;r++)n[e.data[r*e.channels]]++;let i=0,r=0;for(;r<t;){const e='min'===a?i:255-i;if(r+=n[e]/o,i++,255<=i)break}return'min'===a?i:255-i}Object.defineProperty(t,'__esModule',{value:!0}),t.normalize=function(e,t={}){e.colorspace!==A.Colorspace.Greyscale&&e.colorspace!==A.Colorspace.YCbCr&&(e=X.ImageData.toColorspace(e,A.Colorspace.YCbCr));const{strength:n=1,blackPointPercentage:i=0.02,whitePointPercentage:o=0.02,midpointNormalization:r=0}=t,s=a(e,i,'min'),d=a(e,o,'max'),l=a(e,0.5,'min'),h=1+(255/(d-s)-1)*n,g=h*(l-s);for(let a=0;a<e.height;a++)for(let t=0;t<e.width;t++){const n=X.ImageData.indexFor(e,t,a);let i=e.data[n];if(i=i<=s?0:i>=d?255:h*(i-s),r){const e=D(g-i);i+=r*(128-g)*((128-e)/128)}e.data[n]=X.ImageData.clip255(i)}return e}});t(J);var j=a(function(e,t){function a(e){return 0===e?l:1}function n(e){return parseInt(e,16).toString(2).padStart(64,'0')}function i(e){if('string'==typeof e){if(/^(0|1)+$/.test(e))return e;if(/^[a-f0-9]+$/.test(e))return n(e);throw new Error(`Invalid conversion toBinaryString: ${e}`)}return o(e).join('')}function o(e){const t=[];for(let a=0;a<e.length;a++){const n=e[a];for(let e=7;0<=e;e--)t.push(1&n>>e)}return t}function r(e,t=0,n=0){const o=I(e.width,32),i=[];for(let r=0;r<o;r++)for(let s,d=0;d<o;d++){s=0;for(let a=0;a<o;a++)for(let i=0;i<o;i++){const l=(a+1/2)/o*d*m,h=(i+1/2)/o*r*m;s+=c(l)*c(h)*e.data[(i+n)*o+a+t]}s*=a(d)*a(r)/4,i[r*o+d]=s}return i}function s(e,t=8){const a=f(e.length),n=[];for(let o=0;o<t;o++)for(let r=0;r<t;r++)n[o*t+r]=e[o*a+r];return n}function d(e){let t=0;for(let a=1;a<e.length;a++)t+=e[a];const a=t/(e.length-1),n=[];for(let t=0;t<e.length;t++)n[t]=e[t]>a?1:0;return n.join('')}Object.defineProperty(t,'__esModule',{value:!0});const l=1/1.4142135623730951;t.toHexString=function(e){return e.match(/.{4}/gm).map((e)=>parseInt(e,2).toString(16)).join('')},t.toBinaryString=i,t.toBits=o,t.computeDCT=r,t.reduceDCT=s,t.averageAndThreshold=d,t.phash=function(e,t){if(t=t||64,!g(f(t/64)))throw new Error('Hash size must be a square-multiple of 64');const a=32*(t/64);let n=e;if(e.width!==a||e.height!==a||e.colorspace!==A.Colorspace.Greyscale){const t=W.bilinear(e,{width:a,height:a});n=X.ImageData.toGreyscale(t)}const o=[],l=t/64,h=f(l);for(let a=0;a<l;a++){const e=32*(a%h),t=32*C(a/h),i=r(n,e,t),l=s(i);o.push(d(l))}return o.join('')},t.lumaHash=function(e,t){const{hashSize:a=256,lumaHashThreshold:n=30}=t||{},i=f(a);if(!g(i))throw new Error('Hash size must be a square');let o=e;if(e.width!==i||e.height!==i||e.colorspace!==A.Colorspace.Greyscale){const t=W.bilinear(e,{width:i,height:i});o=X.ImageData.toGreyscale(t)}o=J.normalize(o,{strength:0.5});const r=[];for(let a=0;a<i;a++)for(let e=0;e<i;e++)r.push(o.data[a*i+e]>=n?'1':'0');return r.join('')},t.hammingDistance=function(e,t){const a=i(e),n=i(t);let o=0;for(let r=0;r<a.length;r++)a[r]!==n[r]&&o++;return o},t.subsetDistance=function(e,t){const a=i(e),n=i(t);let o=0,r=0,s=0,d=0;for(let l=0;l<a.length;l++){const e='1'===a[l],t='1'===n[l];e&&s++,t&&d++,e&&!t&&o++,!e&&t&&r++}return I(o/s,r/d)}});t(j);var V=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0})});t(V);var q=a(function(e,t){function a(e,t,a,n){for(const i of n)i({invocationId:e,name:t,args:a})}function n(e,n){return function(...o){i++,a(i,e,o,t.instrumentation.onMethodStart);let r=n.apply(this,o);return r&&'function'==typeof r.then?r=r.then((n)=>{return a(i,e,o,t.instrumentation.onMethodComplete),n}).catch((n)=>{throw a(i,e,o,t.instrumentation.onMethodComplete),n}):a(i,e,o,t.instrumentation.onMethodComplete),r}}Object.defineProperty(t,'__esModule',{value:!0});let i=0;t.instrumentation={onMethodStart:[],onMethodComplete:[],wrapMethod:n,wrapAllMethods(e){for(const t of Object.getOwnPropertyNames(e))'function'==typeof e[t]&&(e[t]=n(t,e[t]))}}});t(q);var Z=a(function(e,t){function a(e,t,a){t=t||0,a=I(a||e.length,e.length);let n=0;for(let o=t;o<a;o++)n+=e[o];const i=a-t;return 0==i?0:n/i}Object.defineProperty(t,'__esModule',{value:!0}),t.computeAverage=a,t.sharpness=q.instrumentation.wrapMethod('computeSharpness',function(e,t){const n={x:0,y:0,width:e.width,height:e.height},{threshold:i=20,subselect:o=n}=t||{},r=o.x+o.width,s=o.y+o.height;let d=[];for(let a=o.y;a<s;a++)for(let t=o.x;t<r;t++){const n=X.ImageData.valueFor(e,t,a);n>i&&d.push(n)}d=d.sort((e,t)=>e-t);const l=d.length/e.data.length,h=d[C(d.length/4)],g=d[C(d.length/2)],u=d[C(3*d.length/4)],f=p(d.length/20),c=a(d,0,f),m=a(d),y=a(d,d.length-f);return{percentEdges:l,lowerQuartile:h,median:g,upperQuartile:u,lowerVentileAverage:c,average:m,upperVentileAverage:y}})});t(Z);var K=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.histograms=function(e,t){const{buckets:a=8}=t||{},n=X.ImageData.toHSL(e),o=[],r=[],s=[];for(let n=0;n<a;n++)o[n]=0,r[n]=0,s[n]=0;const i=256/a;for(let a=0;a<n.width;a++)for(let e=0;e<n.height;e++){const t=X.ImageData.indexFor(n,a,e),d=_(255*(n.data[t]/360)),l=n.data[t+1],h=n.data[t+2],g=D(h-0.5),p=f(l*(1-g)),u=C(255*p/i),c=C(d/i),m=C(255*h/i);o[c]+=p,r[u]+=1,s[m]+=1}return{hue:o.map((e)=>_(e)),saturation:r,lightness:s}}});t(K);var Q=a(function(e,t){function a(e,t){const{ruleOfThirdsEdgeThreshold:a,ruleOfThirdsFalloffPoint:n}=t;let i=0;const o=e.height/3,r=2*e.height/3,s=e.width/3,d=2*e.width/3,l=I(o,s),h=f(b(o,2)+b(s,2));let g=0;for(let p=0;p<e.width;p++)for(let t=0;t<e.height;t++){const c=X.ImageData.valueFor(e,p,t);if(c<=a)continue;let m=Infinity,y=Infinity;p<e.width/2?t<e.height/2?(m=D(s-p),y=D(o-t)):(m=D(s-p),y=D(r-t)):t<e.height/2?(m=D(d-p),y=D(o-t)):(m=D(d-p),y=D(r-t));const x=f(b(m,2)+b(y,2)),_=I(m,y);i+=u(n-x/h,0)+(n-_/l),g+=1}return i/g}function n(e,t,a=!1){const{parallelismStreakThreshold:n,parallelismEdgeThreshold:o}=t,r=a?e.height:e.width,s=a?e.width:e.height,d=[];for(let l,h=0;h<r;h++){l=0;const t=[];for(let i=0;i<s;i++){const r=a?i:h,d=a?h:i,g=X.ImageData.indexFor(e,r,d),p=a?90===e.angles[g]:0===e.angles[g],u=e.data[g]>o;p&&u?l++:l&&(l/s>n&&t.push(l),l=0)}l&&t.push(l);const i=Z.computeAverage(t)/s;i>n&&d.push(i)}return Z.computeAverage(d)}Object.defineProperty(t,'__esModule',{value:!0}),t.composition=function(e,t){const i=t&&t.sharpnessAnalysis||Z.sharpness(e),o=I(u(i.average,32),128),r=Object.assign({ruleOfThirdsEdgeThreshold:o,ruleOfThirdsFalloffPoint:0.4,parallelismEdgeThreshold:o,parallelismStreakThreshold:0.05,sharpnessAnalysis:i},t);return{ruleOfThirds:a(e,r),horizontalParallelism:n(e,r,!0),verticalParallelism:n(e,r)}}});t(Q);var $=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.tags={},t.tagsByCode={},t.xmpTags={Rating:!0,Label:!0,MetadataDate:!0,DCSubjectBagOfWords:!0},t.panasonicConversionTags={GPSDestBearingRef:'ISO'};const a=[['ImageWidth',100,4,1],['NewSubfileType',254,4,1],['SubfileType',255,3,1],['ImageWidth',256,4,1],['ImageLength',257,4,1],['BitsPerSample',258,3,1],['Compression',259,3,1],['PhotometricInterpretation',262,3,1],['Thresholding',263,3,1],['CellWidth',264,3,1],['CellLength',265,3,1],['FillOrder',266,3,1],['DocumentName',269,2,1],['ImageDescription',270,2,1],['Make',271,2,1],['Model',272,2,1],['StripOffsets',273,4,1],['Orientation',274,3,1],['SamplesPerPixel',277,3,1],['RowsPerStrip',278,4,1],['StripByteCounts',279,4,1],['MinSampleValue',280,-1,1],['MaxSampleValue',281,-1,1],['XResolution',282,5,1],['YResolution',283,5,1],['PlanarConfiguration',284,3,1],['PageName',285,-1,1],['XPosition',286,-1,1],['YPosition',287,-1,1],['FreeOffsets',288,-1,1],['FreeByteCounts',289,-1,1],['GrayResponseUnit',290,3,1],['GrayResponseCurve',291,3,1],['T4Options',292,4,1],['T6Options',293,4,1],['ResolutionUnit',296,3,1],['PageNumber',297,-1,1],['ColorResponseUnit',300,-1,1],['TransferFunction',301,3,1],['Software',305,2,1],['ModifyDate',306,2,1],['Artist',315,2,1],['HostComputer',316,2,1],['Predictor',317,3,1],['WhitePoint',318,5,1],['PrimaryChromaticities',319,5,1],['ColorMap',320,3,1],['HalftoneHints',321,3,1],['TileWidth',322,3,1],['TileLength',323,3,1],['TileOffsets',324,3,1],['TileByteCounts',325,3,1],['BadFaxLines',326,-1,1],['CleanFaxData',327,-1,1],['ConsecutiveBadFaxLines',328,-1,1],['SubIFD',330,4,1],['InkSet',332,3,1],['InkNames',333,2,1],['NumberOfInks',334,3,1],['DotRange',336,1,1],['TargetPrinter',337,2,1],['ExtraSamples',338,3,1],['SampleFormat',339,3,1],['SMinSampleValue',340,3,1],['SMaxSampleValue',341,3,1],['TransferRange',342,3,1],['ClipPath',343,1,1],['XClipPathUnits',344,4,1],['YClipPathUnits',345,4,1],['Indexed',346,3,1],['JPEGTables',347,7,1],['OPIProxy',351,3,1],['GlobalParametersIFD',400,-1,1],['ProfileType',401,-1,1],['FaxProfile',402,-1,1],['CodingMethods',403,-1,1],['VersionYear',404,-1,1],['ModeNumber',405,-1,1],['Decode',433,-1,1],['DefaultImageColor',434,-1,1],['T82Options',435,-1,1],['JPEGProc',512,4,1],['JPEGInterchangeFormat',513,4,1],['JPEGInterchangeFormatLength',514,4,1],['JPEGRestartInterval',515,3,1],['JPEGLosslessPredictors',517,3,1],['JPEGPointTransforms',518,3,1],['JPEGQTables',519,4,1],['JPEGDCTables',520,4,1],['JPEGACTables',521,4,1],['YCbCrCoefficients',529,5,1],['YCbCrSubSampling',530,3,1],['YCbCrPositioning',531,3,1],['ReferenceBlackWhite',532,5,1],['StripRowCounts',559,-1,1],['XMLPacket',700,1,1],['USPTOMiscellaneous',999,-1,1],['RelatedImageFileFormat',4096,-1,1],['RelatedImageWidth',4097,-1,1],['RelatedImageHeight',4098,-1,1],['Rating',18246,3,1],['XP_DIP_XML',18247,-1,1],['StitchInfo',18248,-1,1],['RatingPercent',18249,3,1],['ImageID',32781,2,1],['WangTag1',32931,-1,1],['WangAnnotation',32932,-1,1],['WangTag3',32933,-1,1],['WangTag4',32934,-1,1],['Matteing',32995,-1,1],['DataType',32996,-1,1],['ImageDepth',32997,-1,1],['TileDepth',32998,-1,1],['Model2',33405,-1,1],['CFARepeatPatternDim',33421,3,1],['CFAPattern',33422,1,1],['BatteryLevel',33423,5,1],['KodakIFD',33424,-1,1],['Copyright',33432,2,1],['ExposureTime',33434,5,1],['FNumber',33437,5,1],['MDFileTag',33445,-1,1],['MDScalePixel',33446,-1,1],['MDColorTable',33447,-1,1],['MDLabName',33448,-1,1],['MDSampleInfo',33449,-1,1],['MDPrepDate',33450,-1,1],['MDPrepTime',33451,-1,1],['MDFileUnits',33452,-1,1],['PixelScale',33550,-1,1],['AdventScale',33589,-1,1],['AdventRevision',33590,-1,1],['UIC1Tag',33628,-1,1],['UIC2Tag',33629,-1,1],['UIC3Tag',33630,-1,1],['UIC4Tag',33631,-1,1],['IPTC-NAA',33723,-1,1],['IntergraphPacketData',33918,-1,1],['IntergraphFlagRegisters',33919,-1,1],['IntergraphMatrix',33920,-1,1],['INGRReserved',33921,-1,1],['ModelTiePoint',33922,-1,1],['Site',34016,-1,1],['ColorSequence',34017,-1,1],['IT8Header',34018,-1,1],['RasterPadding',34019,-1,1],['BitsPerRunLength',34020,-1,1],['BitsPerExtendedRunLength',34021,-1,1],['ColorTable',34022,-1,1],['ImageColorIndicator',34023,-1,1],['BackgroundColorIndicator',34024,-1,1],['ImageColorValue',34025,-1,1],['BackgroundColorValue',34026,-1,1],['PixelIntensityRange',34027,-1,1],['TransparencyIndicator',34028,-1,1],['ColorCharacterization',34029,-1,1],['HCUsage',34030,-1,1],['TrapIndicator',34031,-1,1],['CMYKEquivalent',34032,-1,1],['SEMInfo',34118,-1,1],['AFCP_IPTC',34152,-1,1],['PixelMagicJBIGOptions',34232,-1,1],['ModelTransform',34264,-1,1],['WB_GRGBLevels',34306,-1,1],['LeafData',34310,-1,1],['PhotoshopSettings',34377,1,1],['EXIFTag',34665,4,1],['InterColorProfile',34675,7,1],['TIFF_FXExtensions',34687,-1,1],['MultiProfiles',34688,-1,1],['SharedData',34689,-1,1],['T88Options',34690,-1,1],['ImageLayer',34732,-1,1],['GeoTiffDirectory',34735,-1,1],['GeoTiffDoubleParams',34736,-1,1],['GeoTiffAsciiParams',34737,-1,1],['ExposureProgram',34850,-1,1],['SpectralSensitivity',34852,-1,1],['GPSTag',34853,4,1],['ISO',34855,4,1],['Opto-ElectricConvFactor',34856,-1,1],['Interlace',34857,3,1],['TimeZoneOffset',34858,4,1],['SelfTimerMode',34859,3,1],['SensitivityType',34864,-1,1],['StandardOutputSensitivity',34865,-1,1],['RecommendedExposureIndex',34866,-1,1],['ISOSpeed',34867,-1,1],['ISOSpeedLatitudeyyy',34868,-1,1],['ISOSpeedLatitudezzz',34869,-1,1],['FaxRecvParams',34908,-1,1],['FaxSubAddress',34909,-1,1],['FaxRecvTime',34910,-1,1],['LeafSubIFD',34954,-1,1],['EXIFVersion',36864,-1,1],['DateTimeOriginal',36867,-1,1],['CreateDate',36868,-1,1],['ComponentsConfiguration',37121,-1,1],['CompressedBitsPerPixel',37122,-1,1],['ShutterSpeedValue',37377,-1,1],['ApertureValue',37378,-1,1],['BrightnessValue',37379,-1,1],['ExposureCompensation',37380,-1,1],['MaxApertureValue',37381,-1,1],['SubjectDistance',37382,-1,1],['MeteringMode',37383,-1,1],['LightSource',37384,-1,1],['Flash',37385,-1,1],['FocalLength',37386,-1,1],['FlashEnergy',37387,5,1],['SpatialFrequencyResponse',37388,7,1],['Noise',37389,7,1],['FocalPlaneXResolution',37390,5,1],['FocalPlaneYResolution',37391,5,1],['FocalPlaneResolutionUnit',37392,3,1],['ImageNumber',37393,4,1],['SecurityClassification',37394,2,1],['ImageHistory',37395,2,1],['SubjectArea',37396,-1,1],['ExposureIndex',37397,5,1],['TIFFEPStandardID',37398,1,1],['SensingMethod',37399,3,1],['CIP3DataFile',37434,-1,1],['CIP3Sheet',37435,-1,1],['CIP3Side',37436,-1,1],['StoNits',37439,-1,1],['MakerNote',37500,-1,1],['UserComment',37510,-1,1],['SubSecTime',37520,-1,1],['SubSecTimeOriginal',37521,-1,1],['SubSecTimeDigitized',37522,-1,1],['MSDocumentText',37679,-1,1],['MSPropertySetStorage',37680,-1,1],['MSDocumentTextPosition',37681,-1,1],['ImageSourceData',37724,-1,1],['XPTitle',40091,1,1],['XPComment',40092,1,1],['XPAuthor',40093,1,1],['XPKeywords',40094,1,1],['XPSubject',40095,1,1],['FlashpixVersion',40960,-1,1],['ColorSpace',40961,-1,1],['EXIFImageWidth',40962,-1,1],['EXIFImageHeight',40963,-1,1],['RelatedSoundFile',40964,-1,1],['InteropOffset',40965,-1,1],['SubjectLocation',41492,-1,1],['TIFF-EPStandardID',41494,-1,1],['FileSource',41728,-1,1],['SceneType',41729,-1,1],['CustomRendered',41985,-1,1],['ExposureMode',41986,-1,1],['WhiteBalance',41987,-1,1],['DigitalZoomRatio',41988,-1,1],['FocalLengthIn35mmFormat',41989,-1,1],['SceneCaptureType',41990,-1,1],['GainControl',41991,-1,1],['Contrast',41992,-1,1],['Saturation',41993,-1,1],['Sharpness',41994,-1,1],['DeviceSettingDescription',41995,-1,1],['SubjectDistanceRange',41996,-1,1],['ImageUniqueID',42016,-1,1],['OwnerName',42032,-1,1],['SerialNumber',42033,-1,1],['LensMake',42035,-1,1],['LensModel',42036,-1,1],['LensSerialNumber',42037,-1,1],['GDALMetadata',42112,-1,1],['GDALNoData',42113,-1,1],['Gamma',42240,-1,1],['ExpandSoftware',44992,-1,1],['ExpandLens',44993,-1,1],['ExpandFilm',44994,-1,1],['ExpandFilterLens',44995,-1,1],['ExpandScanner',44996,-1,1],['ExpandFlashLamp',44997,-1,1],['PixelFormat',48129,-1,1],['Transformation',48130,-1,1],['Uncompressed',48131,-1,1],['ImageType',48132,-1,1],['WidthResolution',48258,-1,1],['HeightResolution',48259,-1,1],['ImageOffset',48320,-1,1],['ImageByteCount',48321,-1,1],['AlphaOffset',48322,-1,1],['AlphaByteCount',48323,-1,1],['ImageDataDiscard',48324,-1,1],['AlphaDataDiscard',48325,-1,1],['OceScanjobDesc',50215,-1,1],['OceApplicationSelector',50216,-1,1],['OceIDNumber',50217,-1,1],['OceImageLogic',50218,-1,1],['Annotations',50255,-1,1],['PrintImageMatching',50341,7,1],['USPTOOriginalContentType',50560,-1,1],['DNGVersion',50706,1,1],['DNGBackwardVersion',50707,1,1],['UniqueCameraModel',50708,2,1],['LocalizedCameraModel',50709,1,1],['CFAPlaneColor',50710,1,1],['CFALayout',50711,3,1],['LinearizationTable',50712,3,1],['BlackLevelRepeatDim',50713,3,1],['BlackLevel',50714,5,1],['BlackLevelDeltaH',50715,10,1],['BlackLevelDeltaV',50716,10,1],['WhiteLevel',50717,3,1],['DefaultScale',50718,5,1],['DefaultCropOrigin',50719,3,1],['DefaultCropSize',50720,3,1],['ColorMatrix1',50721,10,1],['ColorMatrix2',50722,10,1],['CameraCalibration1',50723,10,1],['CameraCalibration2',50724,10,1],['ReductionMatrix1',50725,10,1],['ReductionMatrix2',50726,10,1],['AnalogBalance',50727,5,1],['AsShotNeutral',50728,3,1],['AsShotWhiteXY',50729,5,1],['BaselineExposure',50730,10,1],['BaselineNoise',50731,5,1],['BaselineSharpness',50732,5,1],['BayerGreenSplit',50733,4,1],['LinearResponseLimit',50734,5,1],['CameraSerialNumber',50735,2,1],['LensInfo',50736,5,1],['ChromaBlurRadius',50737,5,1],['AntiAliasStrength',50738,5,1],['ShadowScale',50739,10,1],['DNGPrivateData',50740,1,1],['MakerNoteSafety',50741,3,1],['RawImageSegmentation',50752,-1,1],['CalibrationIlluminant1',50778,3,1],['CalibrationIlluminant2',50779,3,1],['BestQualityScale',50780,5,1],['RawDataUniqueID',50781,1,1],['AliasLayerMetadata',50784,-1,1],['OriginalRawFileName',50827,1,1],['OriginalRawFileData',50828,7,1],['ActiveArea',50829,3,1],['MaskedAreas',50830,3,1],['AsShotICCProfile',50831,7,1],['AsShotPreProfileMatrix',50832,10,1],['CurrentICCProfile',50833,7,1],['CurrentPreProfileMatrix',50834,10,1],['ColorimetricReference',50879,3,1],['PanasonicTitle',50898,-1,1],['PanasonicTitle2',50899,-1,1],['CameraCalibrationSignature',50931,1,1],['ProfileCalibrationSignature',50932,1,1],['ProfileIFD',50933,-1,1],['AsShotProfileName',50934,1,1],['NoiseReductionApplied',50935,5,1],['ProfileName',50936,1,1],['ProfileHueSatMapDims',50937,4,1],['ProfileHueSatMapData1',50938,0,1],['ProfileHueSatMapData2',50939,0,1],['ProfileToneCurve',50940,0,1],['ProfileEmbedPolicy',50941,4,1],['ProfileCopyright',50942,1,1],['ForwardMatrix1',50964,10,1],['ForwardMatrix2',50965,10,1],['PreviewApplicationName',50966,1,1],['PreviewApplicationVersion',50967,1,1],['PreviewSettingsName',50968,1,1],['PreviewSettingsDigest',50969,1,1],['PreviewColorSpace',50970,4,1],['PreviewDateTime',50971,2,1],['RawImageDigest',50972,7,1],['OriginalRawFileDigest',50973,7,1],['SubTileBlockSize',50974,4,1],['RowInterleaveFactor',50975,4,1],['ProfileLookTableDims',50981,4,1],['ProfileLookTableData',50982,0,1],['OpcodeList1',51008,7,1],['OpcodeList2',51009,7,1],['OpcodeList3',51022,7,1],['NoiseProfile',51041,-1,1],['TimeCodes',51043,-1,1],['FrameRate',51044,-1,1],['TStop',51058,-1,1],['ReelName',51081,-1,1],['OriginalDefaultFinalSize',51089,-1,1],['OriginalBestQualitySize',51090,-1,1],['OriginalDefaultCropSize',51091,-1,1],['CameraLabel',51105,-1,1],['ProfileHueSatMapEncoding',51107,-1,1],['ProfileLookTableEncoding',51108,-1,1],['BaselineExposureOffset',51109,-1,1],['DefaultBlackRender',51110,-1,1],['NewRawImageDigest',51111,-1,1],['RawToPreviewGain',51112,-1,1],['DefaultUserCrop',51125,-1,1],['Padding',59932,-1,1],['OffsetSchema',59933,-1,1],['OwnerName',65000,-1,1],['SerialNumber',65001,-1,1],['Lens',65002,-1,1],['KDC_IFD',65024,-1,1],['RawFile',65100,-1,1],['Converter',65101,-1,1],['WhiteBalance',65102,-1,1],['Exposure',65105,-1,1],['Shadows',65106,-1,1],['Brightness',65107,-1,1],['Contrast',65108,-1,1],['Saturation',65109,-1,1],['Sharpness',65110,-1,1],['Smoothness',65111,-1,1],['MoireFilter',65112,-1,1],['GPSVersionID',0,1,2],['GPSLatitudeRef',1,2,2],['GPSLatitude',2,5,2],['GPSLongitudeRef',3,2,2],['GPSLongitude',4,5,2],['GPSAltitudeRef',5,1,2],['GPSAltitude',6,5,2],['GPSTimeStamp',7,5,2],['GPSSatellites',8,2,2],['GPSStatus',9,2,2],['GPSMeasureMode',10,2,2],['GPSDOP',11,5,2],['GPSSpeedRef',12,2,2],['GPSSpeed',13,5,2],['GPSTrackRef',14,2,2],['GPSTrack',15,5,2],['GPSImgDirectionRef',16,2,2],['GPSImgDirection',17,5,2],['GPSMapDatum',18,2,2],['GPSDestLatitudeRef',19,2,2],['GPSDestLatitude',20,5,2],['GPSDestLongitudeRef',21,2,2],['GPSDestLongitude',22,5,2],['GPSDestBearingRef',23,2,2],['GPSDestBearing',24,5,2],['GPSDestDistanceRef',25,2,2],['GPSDestDistance',26,5,2],['GPSProcessingMethod',27,7,2],['GPSAreaInformation',28,7,2],['GPSDateStamp',29,2,2],['GPSDifferential',30,3,2],['GPSHPositioningError',31,5,2]];for(const[n,i,o,r]of a){if(t.tagsByCode[i])throw new Error(`Duplicate code (${i}): ${n}`);const e={name:n,code:i,dataType:o,group:r};t.tags[n]=e,t.tagsByCode[i]=e}t.getFriendlyName=function(e){return t.tagsByCode[e]&&t.tagsByCode[e].name||'Unknown'}});t($);var ee=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});var a;(function(e){e[e.Big=0]='Big',e[e.Little=1]='Little'})(a=t.Endian||(t.Endian={})),t.BIG_ENDIAN_MARKER=19789,t.LITTLE_ENDIAN_MARKER=18761;var n;(function(e){e[e.JpgFromRaw=46]='JpgFromRaw',e[e.Compression=259]='Compression',e[e.StripOffsets=273]='StripOffsets',e[e.SamplesPerPixel=277]='SamplesPerPixel',e[e.RowsPerStrip=278]='RowsPerStrip',e[e.StripByteCounts=279]='StripByteCounts',e[e.XResolution=282]='XResolution',e[e.YResolution=283]='YResolution',e[e.SubIFD=330]='SubIFD',e[e.ThumbnailOffset=513]='ThumbnailOffset',e[e.ThumbnailLength=514]='ThumbnailLength',e[e.EXIFOffset=34665]='EXIFOffset',e[e.PanasonicJPEGEnd=280]='PanasonicJPEGEnd',e[e.ISO=34855]='ISO',e[e.MakerNote=37500]='MakerNote'})(n=t.IFDTag||(t.IFDTag={}));var i;(function(e){e[e.Image=0]='Image',e[e.EXIF=1]='EXIF',e[e.GPS=2]='GPS'})(i=t.IFDGroup||(t.IFDGroup={}));var o;(function(e){e[e.Unknown=0]='Unknown',e[e.Byte=1]='Byte',e[e.String=2]='String',e[e.Short=3]='Short',e[e.Long=4]='Long',e[e.Rational=5]='Rational',e[e.SignedByte=6]='SignedByte',e[e.Undefined=7]='Undefined',e[e.SignedShort=8]='SignedShort',e[e.SignedLong=9]='SignedLong',e[e.SignedRational=10]='SignedRational',e[e.Float=11]='Float',e[e.Double=12]='Double'})(o=t.IFDDataType||(t.IFDDataType={})),t.getDataTypeSize=function(e,t){switch(e){case o.Unknown:case o.Undefined:case o.Byte:case o.String:case o.SignedByte:return 1;case o.Short:case o.SignedShort:return 2;case o.Long:case o.SignedLong:case o.Float:return 4;case o.Rational:case o.SignedRational:case o.Double:return 8;default:{const a=t?` for name (${t})`:'';throw new TypeError(`unknown datatype${a}: ${e}`)}}}});t(ee);var te=function(){return function(){}},ae=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.createLogger=function(e){e=`exif:${e}`;const t=te(e),a=te(`${e}:verbose`);return t.verbose=a,t}});t(ae);var ne=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});t.Writer=class{constructor(e,t={}){this._bytes=[],this._position=0,this._endianness=ee.Endian.Big,e&&(t.dangerouslyAvoidCopy?this._bytes=e:this.writeBuffer(e))}getPosition(){return this._position}setEndianess(e){this._endianness=e}write(e,t=1){if('string'==typeof e){for(let t=0;t<e.length;t++)this._bytes[this._position]=e.charCodeAt(t),this._position++;return this._bytes[this._position]=0,void this._position++}if(e>b(256,t))throw new Error(`Cannot fit ${e} into ${t} bytes`);if(4<t)throw new Error('Cannot write more than 4 bytes at once');this._endianness===ee.Endian.Little?this._writeLE(e,t):this._writeBE(e,t)}_writeLE(e,t){for(let a=0;a<t;a++)this._bytes[this._position]=255&e>>8*a,this._position++}_writeBE(e,t){for(let a=0;a<t;a++)this._bytes[this._position]=255&e>>8*(t-a-1),this._position++}writeBuffer(e){for(let t=0;t<e.length;t++)this._bytes[this._position]=e[t],this._position++}skip(e){this._position+=e}seek(e){this._position=e}toBuffer(){return new Uint8Array(this._bytes)}static spliceBufferRange(e,t,a,n){const i=e.slice(0,a),o=e.slice(n);return Buffer.concat([i,t,o])}}});t(ne);var ie=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});class a{constructor(e,t=0,a=ee.Endian.Big){this._buffer=e,this._position=t,this._endianness=a}getBuffer(){return this._buffer}hasNext(){return this._position<this._buffer.length}getPosition(){return this._position}getEndianess(){return this._endianness}setEndianess(e){this._endianness=e}read(e){const t=this._endianness===ee.Endian.Little?this._readLE(e):this._readBE(e);return this._position+=e,t}_readLE(e){let t=0;for(let a=e-1;0<=a;a--)t=t<<8|this._buffer[this._position+a];return t}_readBE(e){let t=0;for(let a=0;a<e;a++)t=t<<8|this._buffer[this._position+a];return t}readAsString(e){return this.readAsBuffer(e).toString()}readAsHex(e){const t=2,a=[];for(let n=0;n<e;n+=t){const i=I(t,e-n);let o=this.read(i).toString(16);for(;o.length<2*i;)o=`0${o}`;a.push(o)}return this._endianness===ee.Endian.Big?a.join(''):a.reverse().join('')}readAsBuffer(e){const t=this._buffer.slice(this._position,this._position+e);return this._position+=e,t}readAsReader(e){return new a(this.readAsBuffer(e),0,this._endianness)}skip(e){this._position+=e}seek(e){this._position=e}use(e){const t=this._position,a=e();return this._position=t,a}}t.Reader=a});t(ie);var oe=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});const a=ae.createLogger('ifd-entry');class n{constructor(e,t,a,n,i){this.startOffset=e,this.tag=t,this.dataType=a,this.length=n,this.dataReader=i}get lengthInBytes(){return this.length*ee.getDataTypeSize(this.dataType,this.tag)}get friendlyTagName(){return $.getFriendlyName(this.tag)}getValue(e){const t=this.getReader(e);switch(this.dataType){case ee.IFDDataType.Byte:case ee.IFDDataType.Short:case ee.IFDDataType.Long:case ee.IFDDataType.SignedByte:case ee.IFDDataType.SignedShort:case ee.IFDDataType.SignedLong:return t.read(this.lengthInBytes);case ee.IFDDataType.Rational:case ee.IFDDataType.SignedRational:return t.read(4)/t.read(4);case ee.IFDDataType.String:const e=[];for(;t.hasNext();){const a=t.read(1);if(0===a)break;e.push(y(a))}return e.join('');case ee.IFDDataType.Float:return new DataView(t.readAsBuffer(4).buffer).getFloat32(0);case ee.IFDDataType.Double:return new DataView(t.readAsBuffer(8).buffer).getFloat64(0);case ee.IFDDataType.Undefined:case ee.IFDDataType.Unknown:return t.getBuffer();default:throw new TypeError(`Unsupported data type (${this.dataType}) for tag (${this.tag})`);}}getReader(e){if(this.dataReader.seek(0),4>=this.lengthInBytes)return this.dataReader;if(!e)throw new Error('Cannot read value of IFD entry without a reader');const t=this.dataReader.read(4);return e.use(()=>{return e.seek(t),e.readAsReader(this.lengthInBytes)})}static read(e){const t=e.getPosition(),i=e.read(2),o=e.read(2),r=e.read(4),s=e.readAsReader(4);return a.verbose(`read tag ${$.getFriendlyName(i)} (tag: ${i}, length: ${r})`),new n(t,i,o,r,s)}static mutate(e,t,a,i){if(t.dataType!==ee.IFDDataType.String)throw new Error('Can only mutate strings');0!==a[a.length-1]&&(a=Buffer.concat([a,Buffer.from([0])]));const o=new ie.Reader(e,t.startOffset);o.setEndianess(i);const r=n.read(o);if(4>=r.lengthInBytes)throw new Error('Can only change strings of length >3');const s=a.length,d=new ne.Writer(e,{dangerouslyAvoidCopy:!0});d.setEndianess(i),d.seek(r.startOffset+4),d.write(s,4),r.dataReader.seek(0);const l=r.dataReader.read(4);return ne.Writer.spliceBufferRange(e,a,l,l+r.lengthInBytes)}}t.IFDEntry=n});t(oe);var re=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});class a{constructor(e,t,a){this.entries=t,this.nextIFDOffset=a,this.offset=e.offset,this.parent=e.parent,this.children=[],e.parent&&e.parent.children.push(this)}get isEXIF(){if(!this.parent)return!1;const e=this.parent.entries.find((e)=>e.tag===ee.IFDTag.EXIFOffset),t=e&&e.getValue();return t===this.offset}get isThumbnail(){return!!this.parent&&this.parent.entries.some((e)=>e.tag===ee.IFDTag.ThumbnailOffset)}getSubIFDOffsets(e){const t=[];return this.entries.forEach((a)=>{if(a.tag===ee.IFDTag.SubIFD||a.tag===ee.IFDTag.EXIFOffset)for(const n=a.getReader(e);n.hasNext();)t.push(n.read(4))}),t}static read(e,t){e.seek(t.offset);const n=e.read(2),o=[];for(let a=0;a<n;a++)o.push(oe.IFDEntry.read(e));const i=e.read(4);return new a(t,o,i)}}t.IFD=a});t(re);var se=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});const a=ae.createLogger('encoder'),n=new Set([ee.IFDTag.SubIFD,ee.IFDTag.EXIFOffset,ee.IFDTag.StripOffsets,ee.IFDTag.StripByteCounts,ee.IFDTag.ThumbnailOffset,ee.IFDTag.ThumbnailLength,ee.IFDTag.RowsPerStrip]),i=new Set([$.tags.ImageWidth.code,$.tags.ImageLength.code,$.tags.Orientation.code,$.tags.ISO.code,$.tags.Compression.code,$.tags.ResolutionUnit.code,$.tags.PhotometricInterpretation.code,$.tags.SamplesPerPixel.code,$.tags.PlanarConfiguration.code,$.tags.MeteringMode.code,$.tags.YCbCrPositioning.code,$.tags.BitsPerSample.code,$.tags.NewSubfileType.code,$.tags.AsShotNeutral.code,$.tags.CalibrationIlluminant1.code,$.tags.CalibrationIlluminant2.code,$.tags.WhiteLevel.code,$.tags.TileWidth.code,$.tags.TileLength.code,$.tags.GPSTag.code]);class o{static isSupportedEntry(e,t){return!!e&&!(e.group!==ee.IFDGroup.EXIF)&&!n.has(e.code)&&!!i.has(e.code)&&!('number'!=typeof t)&&(e.dataType===ee.IFDDataType.Short?65536>t:!(e.dataType!==ee.IFDDataType.Long)&&4294967296>t)}static encode(e){const t=new ne.Writer;t.write(ee.BIG_ENDIAN_MARKER,2),t.write(42,2),t.write(8,4);const n=Object.keys(e).map((t)=>{const a=t;return{tag:$.tags[a],value:e[a]}}).filter((e)=>o.isSupportedEntry(e.tag,e.value));a(`writing ${n.length} entries`),t.write(n.length,2);for(const{tag:i,value:o}of n){a.verbose(`writing ${o} to ${i.name}`),t.write(i.code,2),t.write(i.dataType,2),t.write(1,4);const e=1*ee.getDataTypeSize(i.dataType);t.write(o,e),t.skip(4-e)}return t.toBuffer()}}t.TIFFEncoder=o});t(se);var de=a(function(e,t){function a(e,t,a){for(let n=0;n<t.length;n++){const i=n+a;if(e[i]!==t[n])return!1}return!0}Object.defineProperty(t,'__esModule',{value:!0});var n;(function(e){e.Standard='standard',e.Olympus='olympus',e.Panasonic='panasonic',e.Unknown='unknown'})(n||(n={}));const i=ae.createLogger('decoder');class o{constructor(e){this._buffer=e,this._reader=new ie.Reader(e),this._variant=n.Unknown}_readAndValidateHeader(){this._reader.seek(0);const e=this._reader.read(2);if(e===ee.LITTLE_ENDIAN_MARKER)i('interpreting as little endian'),this._reader.setEndianess(ee.Endian.Little);else if(e===ee.BIG_ENDIAN_MARKER)i('interpreting as big endian'),this._reader.setEndianess(ee.Endian.Big);else throw new Error('Unrecognized TIFF format');const t=this._reader.read(2);if(t===42&&(this._variant=n.Standard),t===20306&&(this._variant=n.Olympus),t===85&&(this._variant=n.Panasonic),this._variant===n.Unknown)throw new Error(`Unrecognized TIFF version: ${t.toString(16)}`);i(`detected tiff variant as ${this._variant}`)}_readIFDs(){if(!this._ifds){this._ifds=[];for(const e=[{offset:this._reader.read(4)}];e.length;){const t=e.shift();if(this._ifds.some((e)=>e.offset===t.offset))continue;i(`reading IFD at ${t.offset}`);const a=re.IFD.read(this._reader,t);this._ifds.push(a);const n=a.getSubIFDOffsets(this._reader);i(`IFD has ${n.length} child(ren)`),n.forEach((t)=>e.push({offset:t,parent:a})),a.nextIFDOffset&&e.push({offset:a.nextIFDOffset,parent:a.parent})}}}_readLargestJPEGThumbnail(){let e;if(this._ifds.forEach((t)=>{const a=t.entries.find((e)=>e.tag===ee.IFDTag.ThumbnailOffset),n=t.entries.find((e)=>e.tag===ee.IFDTag.ThumbnailLength);if(a&&n){const i=a.getValue(this._reader),o=n.getValue(this._reader);(!e||o>e.length)&&(e={offset:i,length:o,ifd:t})}}),!!e)return this._reader.seek(e.offset),this._reader.readAsBuffer(e.length)}_readStripOffsetsAsJPEG(){let e;return this._ifds.forEach((t)=>{const a=t.entries.find((e)=>e.tag===ee.IFDTag.Compression),n=t.entries.find((e)=>e.tag===ee.IFDTag.StripOffsets),i=t.entries.find((e)=>e.tag===ee.IFDTag.StripByteCounts);if(!a||!n||!i)return;const o=a.getValue(this._reader);if(6!==o&&7!==o)return;const r=n.getValue(this._reader),s=i.getValue(this._reader),d=this._reader.use(()=>{return this._reader.seek(r),this._reader.readAsBuffer(s)});if(he.JPEGDecoder.isJPEG(d)){const t=new he.JPEGDecoder(d),a=t.extractMetadata();a.ImageLength&&a.ImageWidth&&(e&&!(a.ImageWidth>e.metadata.ImageWidth)||(e={metadata:a,buffer:d}))}}),e?e.buffer:void 0}_findJPEGInRange(e,t,a){var n=Number.isFinite;const o=[],r=[];for(let n=t;n<a;n++)255===e[n]&&216===e[n+1]&&255===e[n+2]&&o.push(n);for(let n=a;n>t;n--)255===e[n-1]&&217===e[n]&&r.push(n);if(25<o.length*r.length)return;let s,d=-Infinity;for(const l of o)for(const t of r){if(!n(l))continue;if(!n(t))continue;if(4e3>t-l)continue;i(`evaluating possible embedded JPEG from ${l} to ${t}`);const a=e.slice(l,t+1);if(!he.JPEGDecoder.isJPEG(a))continue;const o=new he.JPEGDecoder(a).extractMetadata();'number'!=typeof o.ImageWidth||o.ImageWidth<d||(d=o.ImageWidth,s=a)}return s}_readPanasonicJPEG(){if(this._variant!==n.Panasonic)return;const e=this.extractIFDEntries(),t=e.find((e)=>e.tag===ee.IFDTag.JpgFromRaw);if(t){const e=t.getValue(this._reader);if(Buffer.isBuffer(e))return e}const a=u(...e.map((e)=>e.startOffset)),i=this._ifds[0].entries.find((e)=>e.tag===ee.IFDTag.PanasonicJPEGEnd);if(a&&i){const e=i.getValue();return'number'==typeof e?this._findJPEGInRange(this._reader.getBuffer(),a,e):void 0}}_readOlympusJPEG(){if(this._variant===n.Olympus){const e=[1,1,4,0,1,0],t=[2,1,4,0,1,0],n=[255,216,255],i=this.extractIFDEntries(),o=i.find((e)=>37500===e.tag);if(o){const r=o.getValue(this._reader);if('string'!=typeof r&&'number'!=typeof r){const o=new ie.Reader(r);o.setEndianess(ee.Endian.Little);for(let s=0;s<r.length;s++){if(!a(r,e,s))continue;if(!a(r,t,s+12))continue;o.seek(s);const i=oe.IFDEntry.read(o),d=i.getValue(o);if('number'!=typeof d)continue;if(!a(r,n,d))continue;o.seek(s+12);const l=oe.IFDEntry.read(o),h=l.getValue(o);if('number'!=typeof h)continue;const g=r.slice(d,d+h);if(he.JPEGDecoder.isJPEG(g))return g}return this._findJPEGInRange(r,0,r.length)}}}}_readLargestJPEG(){const e=this._readLargestJPEGThumbnail(),t=e&&e.length||0;if(e&&t>500000)return e;const a=this._readStripOffsetsAsJPEG();if(a&&a.length>t)return a;if(e)return e;const n=this._readPanasonicJPEG();if(n)return n;const i=this._readOlympusJPEG();if(i)return i;throw new Error('Could not find an embedded JPEG')}_mergeIFDMetadata(e){const t={},a=e.filter((e)=>!e.ifd.isEXIF),n=e.filter((e)=>e.ifd.isEXIF),i=e.filter((e)=>0===e.metadata.NewSubfileType);for(const{metadata:i}of a.concat(n))Object.assign(t,i);for(const{metadata:a}of i){const{ImageWidth:e,ImageLength:n}=a;!e||!n||Object.assign(t,{ImageWidth:e,ImageLength:n})}return t}extractJPEG(e={}){if(this._cachedJPEG)return this._cachedJPEG.slice();this._readAndValidateHeader(),this._readIFDs();const t=this._readLargestJPEG();if(e.skipMetadata)return t;const a=this.extractMetadata();return this._cachedJPEG=o.injectMetadataIntoJPEG(t,a),this._cachedJPEG.slice()}extractMetadata(){if(this._cachedMetadata)return Object.assign({},this._cachedMetadata);this._readAndValidateHeader(),this._readIFDs();const e=[];return this._ifds.forEach((t)=>{const a={};t.entries.forEach((o)=>{const r=$.getFriendlyName(o.tag),s=o.getValue(this._reader),d='string'==typeof s||'number'==typeof s?s.toString():s.slice(0,32);if(i.verbose(`evaluated ${r} (${o.tag} - ${o.dataType}) as ${d}`),'string'==typeof s||'number'==typeof s){a[r]=s;const i=$.panasonicConversionTags[r];this._variant===n.Panasonic&&i&&(a[i]=s),e.push({ifd:t,metadata:a})}})}),this._cachedMetadata=this._mergeIFDMetadata(e),Object.assign({},this._cachedMetadata)}extractIFDEntries(){return this._readAndValidateHeader(),this._readIFDs(),this._ifds.map((e)=>e.entries).reduce((e,t)=>e.concat(t),[])}static injectMetadataIntoJPEG(e,t){const a=Object.assign({},t);delete a.ImageWidth,delete a.ImageLength,delete a.EXIFImageWidth,delete a.EXIFImageHeight;const n=se.TIFFEncoder.encode(a);return he.JPEGDecoder.injectEXIFMetadata(e,n)}static isLikelyTIFF(e){return 73===e[0]&&73===e[1]||77===e[0]&&77===e[1]}static replaceIFDEntry(e,t,a){const n=e.extractIFDEntries().find((e)=>$.getFriendlyName(e.tag)===t);if(!n)throw new Error(`Could not find "${t}" in buffer`);return oe.IFDEntry.mutate(Buffer.from(e._buffer),n,a,e._reader.getEndianess())}}t.TIFFDecoder=o});t(de);var le=a(function(e,t){function a(e){return /^(([1-9]\d*)|0)$/.test(e)}function n(e){return /^[1-9]\d*\/[1-9]\d*$/.test(e)}function i(e,t){return new RegExp(`<${e}>((.|\\s)*?)</${e}>`,t)}function o(e,t){const a=i(t,'i'),n=e.match(a);return n?{innerXML:n[1]}:null}function r(e,t){const a=e.match(i(t,'ig'));return a?a.map((e)=>o(e,t)):[]}Object.defineProperty(t,'__esModule',{value:!0});const s=/(xmp|exif|tiff):([0-9a-z]+?)="(.*?)"/gim,d=/:([0-9a-z]+?)="(.*?)"$/i,l=/<((xmp|exif|tiff):([0-9a-z]+?))>((.|\\s)*?)<\/\1>/gim,h=new RegExp(l.source,'im');t.XMPDecoder=class{constructor(e){this._text=e.toString()}_handleMatch(e,t,i){if(!(e in $.tags)&&!(e in $.xmpTags))return;let o;if(a(t))o=+t;else if(n(t)){const[e,a]=t.split('/');o=+e/+a}else o=t;i[e]=o}_decodeAttributeMetadata(e){const t=this._text.match(s);for(const a of t||[]){const[t,n,i]=a.match(d)||['','',''];this._handleMatch(n,i,e)}}_decodeElementMetadata(e){const t=this._text.match(l);for(const a of t||[]){const[t,n,i,o,r]=a.match(h)||['','','','',''];this._handleMatch(o,r,e)}}_decodeKeywords(e){const t=o(this._text,'dc:subject');if(t){const a=o(t.innerXML,'rdf:Bag');if(a){const t=r(a.innerXML,'rdf:li');t.length&&(e.DCSubjectBagOfWords=JSON.stringify(t.map((e)=>e.innerXML)))}}}extractJPEG(){throw new Error('No image preview available from XMP')}extractMetadata(){const e={};return this._decodeAttributeMetadata(e),this._decodeElementMetadata(e),this._decodeKeywords(e),e}static isXMP(e){const t='<x:xmpmet';for(let a=0;a<t.length;a++)if(e[a]!==t.charCodeAt(a)&&e[a]!=='<?xpacket'.charCodeAt(a))return!1;return!0}}});t(le);var he=a(function(e,t){function a(e,t=2){const a=new ne.Writer;return a.write(e,t),a.toBuffer()}Object.defineProperty(t,'__esModule',{value:!0});const n=ae.createLogger('jpeg-decoder'),i=1165519206,o='http://ns.adobe.com/xap/1.0/\0',r=65505,s=65496;class d{constructor(e){this._buffer=e,this._reader=new ie.Reader(e),this._reader.setEndianess(ee.Endian.Big)}_handleEXIFMarker(e){const t=this._reader,a=this._markers[this._markers.length-1],n=this._exifBuffers;return a.isEXIF=!0,t.skip(6),n.push(t.readAsBuffer(e.length-6)),{nextMarker:t.read(2)}}_handleXMPMarker(e){const t=this._reader,a=this._markers[this._markers.length-1],n=this._xmpBuffers,i=t.readAsBuffer(o.length).toString();return i===o?(n.push(t.readAsBuffer(e.length-o.length)),a.isXMP=!0,{nextMarker:t.read(2)}):(t.seek(e.nextPosition),{nextMarker:t.read(2)})}_handleNonAppMarker(e){const t=this._reader,{marker:a,nextPosition:n}=e;return(a===65472||a===65473||a===65474)&&(t.skip(1),this._height=t.read(2),this._width=t.read(2)),t.seek(n),{nextMarker:t.read(2)}}_handleMarker(e){const t=this._reader,{marker:a,nextPosition:n}=e;if(a===r){const a=t.use(()=>t.read(4));return a===i?this._handleEXIFMarker(e):a===1752462448?this._handleXMPMarker(e):(t.seek(n),{nextMarker:t.read(2)})}if(255==a>>8)return this._handleNonAppMarker(e);throw new Error(`Unrecognized marker: ${a.toString(16)}`)}_readFileMarkers(){if(this._markers)return;const e={isEXIF:!1,isXMP:!1},t=this._reader;this._markers=[Object.assign({marker:s,buffer:Buffer.from([])},e)],this._exifBuffers=[],this._xmpBuffers=[],t.seek(2);let a=t.read(2);for(;a!==65497&&t.hasNext()&&(n(`read marker ${a.toString(16)}`),a!==65498);){const n=t.use(()=>t.read(2))-2,i=t.use(()=>t.readAsBuffer(n+2));this._markers.push(Object.assign({marker:a,buffer:i},e)),t.skip(2);const o=t.getPosition()+n;a=this._handleMarker({marker:a,nextPosition:o,length:n}).nextMarker}this._markers.push(Object.assign({marker:a,buffer:this._buffer.slice(t.getPosition())},e))}extractJPEG(){return this._buffer}extractMetadata(){this._readFileMarkers();const e={ImageLength:this._height,ImageWidth:this._width};for(const t of this._exifBuffers){const a=new de.TIFFDecoder(t);Object.assign(e,a.extractMetadata())}for(const t of this._xmpBuffers){const a=new le.XMPDecoder(t);Object.assign(e,a.extractMetadata())}return e}extractEXIFBuffer(){return this._readFileMarkers(),this._exifBuffers[0]}extractXMPBuffer(){return this._readFileMarkers(),this._xmpBuffers[0]}static isJPEG(e){try{return new d(e)._readFileMarkers(),!0}catch(e){return n(`not a JPEG, decoding failed with ${e.message}`),!1}}static isLikelyJPEG(e){return 255===e[0]&&216===e[1]&&255===e[2]}static injectEXIFMetadata(e,t){const n=new d(e);n._readFileMarkers();const o=n._markers.some((e)=>e.isEXIF),l=[];for(const{marker:d,buffer:h,isEXIF:g}of n._markers)g||d===s&&!o?(d===s&&l.push(a(s)),l.push(a(r)),l.push(a(t.length+8,2)),l.push(a(i,4)),l.push(a(0,2)),l.push(t)):l.push(a(d),h);return Buffer.concat(l)}static injectXMPMetadata(e,t){const n=new d(e);n._readFileMarkers();const i=n._markers.some((e)=>e.isXMP),l=[];for(const{marker:d,buffer:h,isXMP:g}of n._markers)g||d===s&&!i?(d===s&&l.push(a(s)),l.push(a(r)),l.push(a(t.length+o.length+2,2)),l.push(Buffer.from(o)),l.push(t)):l.push(a(d),h);return Buffer.concat(l)}}t.JPEGDecoder=d});t(he);var ge=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});const a=ae.createLogger('decoder');t.FUJI_MAGIC_STRING='FUJIFILMCCD-RAW';t.FujiDecoder=class{constructor(e){this._reader=new ie.Reader(e)}_readAndValidateHeader(){this._reader.seek(0),this._reader.setEndianess(ee.Endian.Big);const e=this._reader.readAsString(t.FUJI_MAGIC_STRING.length);if(this._reader.skip(1),e!==t.FUJI_MAGIC_STRING)throw new Error('Missing magic FUJI marker');const n=this._reader.readAsString(4);if('0200'!==n&&'0201'!==n)throw new Error(`Unrecognized Fuji version: "${n}"`);const i=this._reader.read(8),o=this._reader.readAsString(32);a(`read from fujifilm raf - ${o} (${i})`)}extractJPEG(){this._readAndValidateHeader(),this._reader.skip(24);const e=this._reader.read(4),t=this._reader.read(4);return this._reader.seek(e),this._reader.readAsBuffer(t)}extractMetadata(){return new he.JPEGDecoder(this.extractJPEG()).extractMetadata()}}});t(ge);var pe=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});const a=ae.createLogger('decoder'),n=new Set(['moov','trak','mdia','minf','dinf','stbl']),i=new Set(['CMT1','CMT2','CMT3','CMT4','CMTA']);class o{constructor(e){this._reader=new ie.Reader(e),this._data=[]}_handleUuidBox(e){const t=this._reader.readAsHex(16),a=this._reader.getPosition();t==='85c0b687820f11e08111f4ce462b6a48'&&this._readFileBox(a,e),t==='eaf42b5e1c984b88b9fbb7dc406e4d16'&&this._readFileBox(a+8,e)}_readFileBox(e,t){if(this._reader.seek(e),!this._reader.hasNext())return;let i=this._reader.read(4);const o=this._reader.readAsString(4);1===i&&(i=this._reader.read(8)),a(`discovered ${o} box with size ${i}`);const r=this._reader.getPosition(),s=i-(r-e),d={chunkName:o,parents:t,dataOffset:r,dataLength:s};this._data.push(d);const l=[...t,d];n.has(o)&&this._readFileBox(r,l),'uuid'===o&&this._handleUuidBox(l),this._reader.hasNext()&&this._readFileBox(e+i,t)}_readAndValidateBoxes(){if(!this._data.length){if(!o._isLikelyCr3(this._reader))throw new Error('Invalid cr3 file');this._reader.setEndianess(ee.Endian.Big),this._readFileBox(0,[])}}extractJPEG(){this._readAndValidateBoxes();const e=this._data.filter((e)=>'PRVW'===e.chunkName).sort((e,t)=>t.dataLength-e.dataLength);if(!e.length)throw new Error('No preview available');const t=e[0];this._reader.seek(t.dataOffset),this._reader.skip(6);const n=this._reader.read(2),i=this._reader.read(2);this._reader.skip(2);const o=this._reader.read(4);a(`extracting jpeg preview ${n}x${i}, ${o} bytes`);const r=this._reader.readAsBuffer(o),s=this.extractMetadata();return de.TIFFDecoder.injectMetadataIntoJPEG(r,s)}extractMetadata(){this._readAndValidateBoxes();const e={};for(const t of this._data){if(!i.has(t.chunkName))continue;this._reader.seek(t.dataOffset);const a=this._reader.readAsBuffer(t.dataLength);de.TIFFDecoder.isLikelyTIFF(a)&&Object.assign(e,new de.TIFFDecoder(a).extractMetadata())}return e}static _isLikelyCr3(e){return e.use(()=>{e.seek(4);const t=e.readAsString(4),a=e.readAsString(4).trim();return'ftyp'===t&&'crx'===a})}static isLikelyCr3(e){return o._isLikelyCr3(new ie.Reader(e))}}t.Cr3Decoder=o});t(pe);var ue=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.parseKeywords=function(e){if('string'==typeof e.DCSubjectBagOfWords)try{return JSON.parse(e.DCSubjectBagOfWords)}catch(e){}}});t(ue);var fe=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});var a;(function(e){e.Element='element',e.Attribute='attribute'})(a||(a={}));const n=Object.assign({},$.xmpTags,{DateTimeOriginal:!0}),i=ae.createLogger('xmp-encoder'),o=`
  <rdf:Description rdf:about=""
    xmlns:xmp="http://ns.adobe.com/xap/1.0/"
    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
    xmlns:exif="http://ns.adobe.com/exif/1.0/"
    xmlns:dc="http://purl.org/dc/elements/1.1/">
  </rdf:Description>
`.trim(),r=`
 <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  ${o}
 </rdf:RDF>
`.trim(),s=`
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 5.6-c140 79.160451, 2017/05/06-01:08:21">
 ${r}
</x:xmpmeta>
`.trim(),d='<?xpacket begin="" id="W5M0MpCehiHzreSzNTczkc9d"?>',l='\n   ';class h{static isWrappedInPacket(e){const t=e.slice(0,d.length).toString();return t===d}static generateWhitespaceOfLength(e){let t='';for(;t.length<e;)t+=0==t.length%100||t.length===e-1?'\n':' ';return t}static wrapInPacket(e){return h.isWrappedInPacket(e)?e:Buffer.from([d,e.toString(),h.generateWhitespaceOfLength(2048),'<?xpacket end="w"?>'].join('\n'))}static encode(e,t){let{xmpData:a,extraLength:o}=h._ensureRdfDescription(t);for(const r of Object.keys(e)){const t=r;if(!(t in n)){i(`skipping ${t} which is not a writable tag`);continue}const s=h._processEntry(a,t,e[t]);o+=s.length-a.length,a=s}if(h.isWrappedInPacket(a)){const e=/(\s*)(<\?xpacket end)/im,t=a.match(e);if(!t)throw new Error('Cannot find XMP packet end');const n=t[1].length;if(n>o){i(`adjusting whitespace, our ${o} will fit into ${n}`);const e=a.indexOf(t[0]),r=a.slice(0,e),s=a.slice(e+n),d=n-o,l=h.generateWhitespaceOfLength(d);a=`${r}${l}${s}`}}return Buffer.from(a)}static _ensureRdfDescription(e){let t=(e||s).toString(),a=0;if(t.includes('<rdf:Description'))return{xmpData:t,extraLength:a};if(t.includes('</rdf:RDF>')){const e=t.replace(/(\s*)<\/rdf:RDF>/,`${o}$1</rdf:RDF>`);return a+=e.length-t.length,t=e,{xmpData:t,extraLength:a}}if(t.includes('</x:xmpmeta>')){const e=t.replace(/(\s*)<\/x:xmpmeta>/,`${r}$1</x:xmpmeta>`);return a+=e.length-t.length,t=e,{xmpData:t,extraLength:a}}throw new Error(`XMP data did not contain any discernible rdf markers:\n${t}`)}static _processEntry(e,t,n){i(`processing ${t}`);const o=h._findExisting(e,t);if('undefined'==typeof n){if(!o)return i(`${t} already missing from XMP, skipping`),e;i(`unsetting ${t}`);let a=e.slice(0,o.start);const n=e.slice(o.start+o.length);return n.match(/^(\n|>)/)&&(a=a.replace(/\n +$/,'')),`${a}${n}`}if(i(`writing ${t} with value "${n}"`),o){i(`found existing ${t}`);const a=e.slice(0,o.start),r=e.slice(o.start+o.length),s=h._buildReplacement(t,n,o.type);return`${a}${s}${r}`}i(`did not find existing ${t}`);const r=h._findInsertionPoint(e,t).start,s=e.slice(0,r),d=e.slice(r),g=h._buildReplacement(t,n,a.Attribute),p=`${l}${g}`;return`${s}${p}${d}`}static _findWithRegex(e,t,a){const n=e.match(t);return n?{start:n.index,length:n[0].length,type:a}:void 0}static _findExisting(e,t){if('DCSubjectBagOfWords'===t)return this._findWithRegex(e,/<dc:subject>(.|\s)*?<\/dc:subject>/,a.Element);const n=new RegExp(`([a-z]+):(${t})="(.*?)"`,'i'),i=this._findWithRegex(e,n,a.Attribute);if(i)return i;const o=new RegExp(`<([a-z]+:${t})(\\s*/>|(.*?)</\\1>)`,'i');return this._findWithRegex(e,o,a.Element)}static _findInsertionPoint(e,t){const a=/<rdf:Description[^<]*?>/im,n=e.match(a);if(!n)throw new Error('Unable to find end of rdf:description');const i=n[0],o=e.indexOf(i)+i.length-1,r=o+('DCSubjectBagOfWords'===t?1:0);return{start:r}}static _buildReplacement(e,t,n){if('DCSubjectBagOfWords'===e){const e=ue.parseKeywords({DCSubjectBagOfWords:t});if(!e)throw new Error('Invalid keywords payload');return[`<dc:subject>`,` <rdf:Bag>`,...e.map((e)=>`  <rdf:li>${e.replace(/</g,'')}</rdf:li>`),` </rdf:Bag>`,`</dc:subject>`].join(l)}const i='DateTimeOriginal'===e?'exif':'xmp';return n===a.Attribute?`${i}:${e}="${t}"`:`<${i}:${e}>${t}</${i}:${e}>`}}t.XMPEncoder=h});t(fe);var ce=a(function(e,t){function a(e){return new Date(1e3*e)}function n(e){const t=e.split(' '),a=t[0].replace(/:/g,'-'),n=t[1];return new Date(`${a}T${n}Z`)}Object.defineProperty(t,'__esModule',{value:!0});const i=(e)=>/^\d+:\d+:\d+ \d+:\d+:\d+$/.test(e),o=(e)=>/^\d{4}-\d{2}-\d{2}T[0-9.:]+(-|\+)\d{2}:\d{2}/.test(e),r=(e)=>/^\d{4}-\d{2}-\d{2}T/.test(e);t.parseDate=function(e){let t;return'number'==typeof e?t=a(e):i(e)?t=n(e):o(e)?t=new Date(e):r(e)&&(t=new Date(`${e}Z`)),t&&t.getTime()?t:void 0}});t(ce);var me=a(function(e,t){function a(e,t){const a=e.match(t);return a&&a[1]||void 0}Object.defineProperty(t,'__esModule',{value:!0});const n={make:/^(\w+)/,focalLength:/\b(\d+(-\d+)?mm)\b/,aperture:/\b(F[\d.]+(-[\d.]+)?)\b/};t.parseLens=function(e){const t=e.LensModel;return t&&'string'==typeof t?{model:t,make:a(t,n.make),focalLength:a(t,n.focalLength),aperture:a(t,n.aperture)}:void 0}});t(me);var ye=a(function(e,t){function a(e,t){if('string'==typeof e)return t[e];if('function'==typeof e)return e(t);if(Array.isArray(e)){const n=a(e[0],t);return e[1](n)}throw new TypeError(`Unsupported item: ${e}`)}Object.defineProperty(t,'__esModule',{value:!0});const n={make:['Make'],model:['Model'],width:['EXIFImageWidth','ImageWidth'],height:['EXIFImageHeight','ImageLength'],xResolution:['XResolution'],yResolution:['YResolution'],createdAt:[['DateTimeOriginal',ce.parseDate],['CreateDate',ce.parseDate]],modifiedAt:[['ModifyDate',ce.parseDate]],iso:['ISO'],exposureTime:['ExposureTime'],fNumber:['FNumber'],focalLength:['FocalLength','FocalLengthIn35mmFormat'],normalizedFocalLength:['FocalLengthIn35mmFormat','FocalLength'],exposureCompensation:['ExposureCompensation'],lens:[me.parseLens],rating:['Rating'],colorLabel:['Label'],keywords:[ue.parseKeywords]};t.normalizeMetadata=function(e){const t={_raw:e};for(const i of Object.keys(n)){const o=n[i];let r;for(const t of o)if(r=a(t,e),'undefined'!=typeof r)break;t[i]=r}if(4<(e.Orientation||0)){const e=t.width;t.width=t.height,t.height=e}return t}});t(ye);var xe=a(function(e,t){function a(e){return'function'==typeof e.extractMetadata}function n(e){for(let t=0;t<ge.FUJI_MAGIC_STRING.length;t++)if(e[t]!==ge.FUJI_MAGIC_STRING.charCodeAt(t))return!1;return!0}function i(e){if(a(e))return e;return n(e)?new ge.FujiDecoder(e):pe.Cr3Decoder.isLikelyCr3(e)?new pe.Cr3Decoder(e):de.TIFFDecoder.isLikelyTIFF(e)?new de.TIFFDecoder(e):he.JPEGDecoder.isLikelyJPEG(e)?new he.JPEGDecoder(e):le.XMPDecoder.isXMP(e)?new le.XMPDecoder(e):void 0}function o(e){const t=i(e);if(!t)throw new Error('Unrecognizable file type');return t}Object.defineProperty(t,'__esModule',{value:!0}),t.JPEGDecoder=he.JPEGDecoder,t.FujiDecoder=ge.FujiDecoder,t.TIFFDecoder=de.TIFFDecoder,t.XMPDecoder=le.XMPDecoder,t.TIFFEncoder=se.TIFFEncoder,t.XMPEncoder=fe.XMPEncoder,t.normalizeMetadata=ye.normalizeMetadata,t.isParseable=function(e){return!!i(e)},t.createDecoder=o,t.parse=function(e){return ye.normalizeMetadata(o(e).extractMetadata())}});t(xe);var _e=a(function(e,t){function a(e){if(!e)throw new Error('curve is not defined');let t=-Infinity;for(const a of e){if(2!==a.length)throw new Error(`curve entry ${JSON.stringify(a)} is not a tuple`);if(a[0]<=t)throw new Error('curve entry is not ascending');if(0>a[0]||255<a[0])throw new Error(`invalid curve entry input ${a[0]}`);if(0>a[1]||255<a[1])throw new Error(`invalid curve entry input ${a[0]}`)}return e.length&&0===e[0][0]||(e=[[0,0],...e]),255!==e[e.length-1][0]&&(e=[...e,[255,255]]),e}function n(e){const t=[],a=[],n=[];for(let o=0;o<e.length-1;o++){const[i,r]=e[o],[s,d]=e[o+1],l=s-i,h=d-r;t.push(l),a.push(h),n.push(h/l)}const o=[n[0]];for(let a=0;a<n.length-1;a++){const e=n[a],i=n[a+1];if(0>=e*i)o.push(0);else{const n=t[a],r=t[a+1],s=n+r;o.push(3*s/((s+r)/e+(s+n)/i))}}o.push(n[n.length-1]);const r=[],s=[];for(let a=0;a<o.length-1;a++){const e=o[a],i=o[a+1],d=n[a],l=1/t[a],h=e+i-2*d;r.push((d-e-h)*l),s.push(h*l*l)}const i=[];for(let t,a=0;255>=a;a++){t=-1;for(let n=0;n<e.length;n++){const i=e[n][0];if(i>a)break;t=n}if(-1===t)throw new Error('Error precomputing indexes');const[n,d]=e[t],l=a-n,h=o[t],g=r[t],p=s[t];let u;u=0==l?d:t>=r.length?d+h*l:d+h*l+g*l*l+p*l*l*l,i[a]=X.ImageData.clip255(u)}return i}function i(e,t,a){const n=X.ImageData.channelsFor(e.colorspace),i=n.indexOf(a);if(-1===i)throw new Error('Curves must operate on a channel in the image');for(let n=0;n<e.width;n++)for(let a=0;a<e.height;a++){const o=X.ImageData.indexFor(e,n,a,i),r=e.data[o];e.data[o]=t[r]}return e}function o(e){const t=[];for(const i of e){const e=a(i);e.every(([e,t])=>e===t)||t.push(n(e))}if(!t.length)return[];const i=[];for(let a,n=0;255>=n;n++){a=n;for(const e of t)a=e[a];i[n]=a}return i}function r(e,t,a=A.ColorChannel.Luminance255){if(t=t.filter((e)=>e.length),!t.length)return e;let n=t;'number'==typeof t[0][0]&&(n=[t]);const r=o(n);if(!r.length)return e;if(256!==r.length)throw new Error('Error computing flattened curve');return i(e,r,a)}function s(e){const t=[];for(let a=0;a<e;a++){const n=_(a*(255/(e-1)));t.push([n,n])}return t}function d({contrast:e=0}){return[[0,0],[64,64-64*e],[192,192+62*e],[255,255]]}function l(e){function t(e,t,r){for(let s=0;s<o.length;s++){const[i,d]=o[s],l=D(e-i)/t;if(1<=l)continue;a=!0;const h=c(l*n);o[s][1]=X.ImageData.clip255(d+r*h)}}let a=!1;const n=m/2,o=s(32);return e.whites&&t(256,32,e.whites),e.highlights&&t(192,64,e.highlights),e.midtones&&t(128,128,e.midtones),e.shadows&&t(64,64,e.shadows),e.blacks&&t(0,32,e.blacks),a?o:[]}function h(e,t){if(!t.length)return e;e=X.ImageData.toHSL(e);const a=new Int8Array(360),n=new Float32Array(360),o=new Float32Array(360);for(let r=0;360>r;r++)a[r]=0,n[r]=0,o[r]=0;for(const i of t){const{targetHue:e,targetBreadth:t=45,hueShift:r=0,saturationShift:s=0,lightnessShift:d=0}=i;if(!g(e)||!g(t))throw new Error('Invalid hue target range');for(let l,h=e-t;h<e+t;h++){for(l=h;0>l;)l+=360;l%=360;const i=I(D(e-l),D(e+360-l),D(e-360-l))/t,g=f(1-i);a[l]+=r*g,n[l]+=s*g,o[l]+=d*g}}for(let i=0;i<e.width;i++)for(let t=0;t<e.height;t++){const r=X.ImageData.indexFor(e,i,t),s=e.data[r],d=e.data[r+1],l=e.data[r+2];if(0===a[s]&&0===n[s]&&0===o[s])continue;const h=D(0.5-l)/0.5,g=f(b(1-d,2)+b(h,2));if(1<=g)continue;const p=1-g;e.data[r+0]=X.ImageData.clipChannel(s+p*a[s],A.ColorChannel.Hue),e.data[r+1]=X.ImageData.clipChannel(d+p*n[s],A.ColorChannel.Saturation),e.data[r+2]=X.ImageData.clipChannel(l+p*o[s],A.ColorChannel.Lightness)}return e}function p(e,t){e=X.ImageData.toHSL(e);for(let a=0;a<e.width;a++)for(let n=0;n<e.height;n++){const i=X.ImageData.indexFor(e,a,n,1),o=e.data[i];e.data[i]=X.ImageData.clipChannel(o*(1+t.saturation),A.ColorChannel.Saturation)}return e}Object.defineProperty(t,'__esModule',{value:!0}),t.curves=r,t.hslAdjustments=h,t.tone=function(e,t){const{colorspace:a}=e,n=[],i=l(t);return i&&n.push(i),t.contrast&&n.push(d(t)),t.curve&&n.push(t.curve),n.length&&(e=X.ImageData.toYCbCr(e),e=r(e,n)),t.hsl&&(e=h(e,t.hsl)),t.saturation&&(e=p(e,t)),(t.redCurve||t.greenCurve||t.blueCurve)&&(e=X.ImageData.toRGB(e),t.redCurve&&r(e,t.redCurve,A.ColorChannel.Red),t.greenCurve&&r(e,t.greenCurve,A.ColorChannel.Green),t.blueCurve&&r(e,t.blueCurve,A.ColorChannel.Blue)),X.ImageData.toColorspace(e,a)}});t(_e);var Ie=a(function(e,t){function a(e){return Array.isArray(e[0])}Object.defineProperty(t,'__esModule',{value:!0}),t.ensureFlatMatrix=function(e){if(!e.length)throw new Error('Matrix must have length');let t=e;a(e)&&(t=e.reduce((e,t)=>e.concat(t),[]));const n=f(t.length);if(n!==_(n))throw new Error('Matrix must be square');return t}});t(Ie);var Ce=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.convolve=function(e,t){X.ImageData.assert(e,[A.Colorspace.RGBA]);const n=Ie.ensureFlatMatrix(t),i=e.data,o=new Uint8Array(e.data.length),s=e.width,d=e.height,l=f(n.length),h=C(l/2);for(var p=0;p<d;p++)for(var u=0;u<s;u++){for(var c=0,r=0,g=0,m=0,a=0,y=0;y<l;y++)for(var x=0;x<l;x++){const e=u+x-h,t=p+y-h;if(0<=e&&0<=t&&e<s&&t<d){const o=4*(t*s+e),d=n[y*l+x];a+=d,c+=i[o]*d,r+=i[o+1]*d,g+=i[o+2]*d,m+=i[o+3]*d}}var I=4*(p*s+u);o[I]=X.ImageData.clip255(_(c/a)),o[I+1]=X.ImageData.clip255(_(r/a)),o[I+2]=X.ImageData.clip255(_(g/a)),o[I+3]=X.ImageData.clip255(_(m/a))}return Object.assign({},e,{data:o})}});t(Ce);var be=a(function(e,t){function a(e){var t=4*(e-1);0==t%2&&t++;const a=C(t/2),n=2*e*e,i=[];for(var o=0;o<t;o++){const e=[];for(var r=0;r<t;r++){const t=b(o-a,2)/n,i=b(r-a,2)/n;e[r]=Math.exp(-1*(t+i))}i.push(e)}return i}function n(e,t){const a=f(12*e*e/t+1);var n=C(a);0==n%2&&n--;const o=n+2,r=t*n*n,s=(12*e*e-r-4*t*n-3*t)/(-4*n-4),d=[];for(var l=0;l<t;l++)d.push(l<s?n:o);return d}function o(e,t,a,n,o,r){const s=2*r+1,d=new Uint8Array(o.length);for(var l=0;l<e;l++)for(var i=0;i<a;i++){const e=n(l,0,i),a=n(l,t-1,i),p=o[e],u=o[a];for(var h=p*(r+1),g=0;g<r;g++){const e=n(l,g,i);h+=o[e]}for(var g=0;g<=r;g++){const e=n(l,g,i),t=n(l,g+r,i);h+=o[t]-p,d[e]=h/s}for(var g=r+1;g<t-r;g++){const e=n(l,g,i),t=n(l,g+r,i),a=n(l,g-r-1,i);h+=o[t]-o[a],d[e]=h/s}for(var g=t-r;g<t;g++){const e=n(l,g,i),t=n(l,g-r,i);h+=u-o[t],d[e]=h/s}}return d}function i(e,t){X.ImageData.assert(e,[A.Colorspace.RGBA,A.Colorspace.RGB,A.Colorspace.Greyscale]);var a=t.radius;a||(a=p(e.width/1e3));const n=o(e.width,e.height,e.channels,(t,a,n)=>X.ImageData.indexFor(e,t,a,n),e.data,a),r=o(e.height,e.width,e.channels,(t,a,n)=>X.ImageData.indexFor(e,a,t,n),n,a);for(var s=0;s<r.length;s++)r[s]=_(r[s]);return Object.assign({},e,{data:r})}Object.defineProperty(t,'__esModule',{value:!0}),t.boxBlur=i,t.gaussianBlur=function(e,t){X.ImageData.assert(e,[A.Colorspace.RGBA,A.Colorspace.RGB,A.Colorspace.Greyscale]);var o=t.sigma;if(!o){const e=t.radius||2;o=1+e/2}const r='boolean'==typeof t.approximate?t.approximate:5<=o;if(r){const t=n(o,3);var s=e;return t.forEach((e)=>{s=i(s,{radius:(e-1)/2})}),s}const d=a(o);return Ce.convolve(e,d)}});t(be);var De=a(function(e,t){function a(e){return e.reduce((e,t)=>e+t,0)}function n(e,t){const a=new Uint8Array(e.data.length);for(var n=0,o=0;o<e.height;o++)for(var r=0;r<e.width;r++){if(X.ImageData.isBorder(e,r,o)){a[n]=0,n++;continue}for(var s=o*e.width+r,d=e.data[s],l=X.ImageData.getPixelsForAngle(e,r,o,e.angles[s],t),h=!0,g=0;g<l.length;g++)if(l[g].values[0]>d){h=!1;break}a[n]=h?d:0,n++}return Object.assign({},e,{data:new Uint8Array(a)})}function i(e,t){const a=new Uint8Array(e.data.length),n=new Uint8Array(e.data.length);for(var i=0;i<e.height;i++)for(var o=0;o<e.width;o++){const s=i*e.width+o;if(n[s])continue;if(X.ImageData.isBorder(e,o,i)){a[s]=0;continue}const d=e.data[s];if(d<t.lowThreshold){a[s]=0;continue}if(d>=t.highThreshold){a[s]=255;continue}const l=[{x:o,y:i,values:[d],index:s,colorspace:A.Colorspace.Greyscale}],h=new Set;for(var r=!1;l.length;){const s=l.shift();if(h.add(s.index),s.values[0]>=t.highThreshold){r=!0;break}const d=(e.angles[s.index]+90)%180,g=X.ImageData.getPixelsForAngle(e,o,i,d);g.forEach((e)=>{const i=e.index;h.has(i)||(e.values[0]>=t.lowThreshold?l.push(e):(a[i]=0,n[i]=1))})}for(const e of l)a[e.index]=255,n[e.index]=1;for(const e of h)a[e]=r?255:0,n[e]=1}return Object.assign({},e,{data:a})}function o(e){for(var t=[],n=0;256>n;n++)t[n]=0;for(var n=0;n<e.data.length;n++)t[e.data[n]]++;for(var i,o=-Infinity,r=100,s=t.slice(0,20),d=t.slice(20),l=a(s.map((e,t)=>e*t)),h=a(d.map((e,t)=>e*(t+20))),g=a(s),p=a(d),n=20;240>n;n++){i=t[n],l+=i*n,h-=i*n,g+=i,p-=i;var u=l/g,f=h/p,c=b(u-f,2)*(g/e.data.length)*(p/e.data.length);c>o&&(o=c,r=n)}return r}Object.defineProperty(t,'__esModule',{value:!0}),t.canny=function(e,t){t=t||{},t.radius=t.radius||1;var a=e;if(a.angles||(a=U.sobel(e,t)),X.ImageData.assert(a,[A.Colorspace.Greyscale]),!t.lowThreshold&&!t.highThreshold){const e=o(a);t.highThreshold=e,t.lowThreshold=e/2}else t.lowThreshold?t.highThreshold||(t.highThreshold=2*t.lowThreshold):t.lowThreshold=t.highThreshold/2;const r=n(a,t.radius);return i(r,t)}});t(De);var Se=a(function(e,t){function a(e){const{strength:t=1}=e,a=-1*t;return[[0,a,0],[a,-4*a+1,a],[0,a,0]]}Object.defineProperty(t,'__esModule',{value:!0}),t.sharpen=function(e,t){return Ce.convolve(e,a(t))}});t(Se);var Pe=a(function(e,t){function a(e,t,a){const n={width:1,height:1,channels:3,colorspace:A.Colorspace.HSL,data:[e,t,a]};return X.ImageData.toXYZ(n).data}function n(e){const{redHueShift:t=0,greenHueShift:n=0,blueHueShift:i=0}=e,[o,r,s]=a((360+45*t)%360,1,0.5),[d,l,h]=a(120+45*n,1,0.5),[g,p,u]=a(240+45*i,1,0.5);return{xRed:o,yRed:r,zRed:s,xGreen:d,yGreen:l,zGreen:h,xBlue:g,yBlue:p,zBlue:u}}function i(e,t,a){const n=X.ImageData.channelsFor(e.colorspace).indexOf(a);for(let i=0;i<e.width;i++)for(let a=0;a<e.height;a++){const o=X.ImageData.indexFor(e,i,a),r=e.data[o+n];for(let a=0;a<e.channels;a++){if(a===n)continue;const i=e.data[o+a],s=u(r-i,0);e.data[o+a]=X.ImageData.clip255(i-s*t)}}return e}function o(e,t,a){const n=X.ImageData.channelsFor(e.colorspace),i=n.indexOf(a),o=[0.5,0.7,0.6];for(let n=0;n<e.width;n++)for(let s=0;s<e.height;s++){const d=X.ImageData.indexFor(e,n,s),l=e.data[d+i];for(let a=0;a<e.channels;a++){if(a===i)continue;const n=e.data[d+a],r=u(l-n,0),s=t*o[i];e.data[d+a]=X.ImageData.clip255(n+r*s)}let h=e.data[d+0],r=e.data[d+1],g=e.data[d+2];const p=(u(h,r,g)-I(h,r,g))/255;if(a===A.ColorChannel.Red){const e=1.5*u(r-h,0),a=1.5*u(r-g,0),n=0.75*u(g-h,0),i=0.75*u(g-r,0);h+=0.3*(u(e,n)*t),r+=0.3*(i*t),g+=0.3*(a*t)}else if(a===A.ColorChannel.Green){const e=u(h-r,0),a=u(h-g,0);r+=0.2*(e*t),g+=0.2*(a*t)}else if(a===A.ColorChannel.Blue){const e=0.05*D(h-r)*p;h>r?(h-=3*e,r+=e):(h+=6*e,r-=2*e)}h*=1-0.12*p,r*=1-0.12*p,g*=1-0.12*p,e.data[d+0]=X.ImageData.clip255(h),e.data[d+1]=X.ImageData.clip255(r),e.data[d+2]=X.ImageData.clip255(g)}return e}Object.defineProperty(t,'__esModule',{value:!0}),t.calibrate=function(e,t){const{colorspace:a}=e;if(t.redHueShift||t.greenHueShift||t.blueHueShift){const a=n(t);e=X.ImageData.toXYZ(e,a),e=X.ImageData.toRGB(e)}e=X.ImageData.toRGB(e);const{Red:r,Green:s,Blue:d}=A.ColorChannel,{redSaturationShift:l=0,greenSaturationShift:h=0,blueSaturationShift:g=0}=t;return 0<l&&(e=i(e,l,r)),0<h&&(e=i(e,h,s)),0<g&&(e=i(e,g,d)),0>l&&(e=o(e,-l,r)),0>h&&(e=o(e,-h,s)),0>g&&(e=o(e,-g,d)),X.ImageData.toColorspace(e,a)}});t(Pe);var we=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0});const a='undefined'==typeof Buffer?Uint8Array:Buffer;t.opacity=function(e,t,n){const i=e.data instanceof Uint8Array||e.data instanceof Uint8ClampedArray||e.data instanceof a;if(e.colorspace!==t.colorspace)throw new Error('Colorspaces must match');if(e.data.length!==t.data.length)throw new Error('Sizes must match');if(!i)throw new Error(`Must be Uint8Array but got ${e.data}`);const o=new Uint8Array(e.data.length);if(e.colorspace===A.Colorspace.RGBA)for(let a=0;a<e.width;a++)for(let i=0;i<e.height;i++){const r=X.ImageData.indexFor(e,a,i),s=t.data[r+3]/255,d=n*s,l=e.data[r+3]/255;if(1!=l)throw new Error('Cannot handle transparent backgrounds');const h=d,g=1-d;o[r]=_(e.data[r]*g+t.data[r]*h),o[r+1]=_(e.data[r+1]*g+t.data[r+1]*h),o[r+2]=_(e.data[r+2]*g+t.data[r+2]*h),o[r+3]=255}else{for(let a=0;a<e.data.length;a++)o[a]=_(e.data[a]*(1-n)+t.data[a]*n)}return Object.assign({},e,{data:o})}});t(we);var Fe=a(function(e,t){function a(){let e=4022871197;return function(t){t=t.toString();for(let a=0;a<t.length;a++){e+=t.charCodeAt(a);let n=0.02519603282416938*e;e=n>>>0,n-=e,n*=e,e=n>>>0,n-=e,e+=4294967296*n}return 2.3283064365386963e-10*(e>>>0)}}Object.defineProperty(t,'__esModule',{value:!0}),t.createPRNG=function(e){const t=a(),n={c:1,s0:t(' '),s1:t(' '),s2:t(' '),next(){const e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)}};return n.s0-=t(e),0>n.s0&&(n.s0+=1),n.s1-=t(e),0>n.s1&&(n.s1+=1),n.s2-=t(e),0>n.s2&&(n.s2+=1),n}});t(Fe);var Be=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.noise=function(e,t,a={}){const{seed:n='noise'}=a,i=Fe.createPRNG(n),o=new Uint8Array(e*t),r={width:e,height:t,data:o,colorspace:A.Colorspace.Greyscale,channels:1};for(let n=0;n<e;n++)for(let e=0;e<t;e++)o[X.ImageData.indexFor(r,n,e)]=X.ImageData.clip255(255*i.next());return r}});t(Be);var Me=a(function(e,t){function a(e){return Object.keys(e).every((t)=>!e[t])}var n=x&&x.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function s(e){try{d(n['throw'](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):new a(function(t){t(e.value)}).then(r,s)}d((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,'__esModule',{value:!0});class i{constructor(){this._output={}}reset(){return this._output={},this}options(e){return e.analyze&&this.analyze(e.analyze),e.format&&this.format(e.format),e.resize&&this.resize(e.resize),e.layers&&this.layers(e.layers),e.normalize&&this.normalize(e.normalize),e.calibrate&&this.calibrate(e.calibrate),e.tone&&this.tone(e.tone),e.greyscale&&this.greyscale(e.greyscale),e.sharpen&&this.sharpen(e.sharpen),e.edges&&this.edges(e.edges),e.effects&&this.effects(e.effects),this}format(e){'string'==typeof e&&(e={type:e});const{type:t}=e;if(t!==A.ImageFormat.JPEG&&t!==A.ImageFormat.PNG&&t!==A.ImageFormat.NoTranscode)throw new Error(`Unrecognized format: ${t}`);const a=t===A.ImageFormat.JPEG?{quality:90}:{};return this._output.format=Object.assign({},a,e),this}resize(e){const{Exact:t,Auto:a}=A.ImageResizeFit;if(!e.width&&!e.height&&!e.subselect)throw new TypeError('Must specify a width, height, or subselect');const n=e.fit&&(e.fit===t||e.fit===a);if((!e.width||!e.height)&&!n)throw new TypeError(`Must specify width and height with "${e.fit}" fit`);return this._output.resize=Object.assign({fit:t,method:A.ImageResizeMethod.Bilinear},e),this}layers(e){return this._output.layers=e,this}normalize(e){return this._output.normalize=e,this}calibrate(e){return this._output.calibrate=e,this}tone(e){return this._output.tone=e,this}greyscale(e=!0){return this._output.greyscale=e,this}sharpen(e={}){return this._output.sharpen=e,this}edges(e=A.EdgeMethod.Sobel){let t=e;return'string'==typeof e&&(t={method:e}),this._output.edges=Object.assign({radius:1,blurSigma:2},t),this}effects(e){return this._output.effects=e,this}analyze(e){return this._analyze=e,this}toAnalysis(){return n(this,void 0,void 0,function*(){if(!this._analyze)return Promise.resolve({});const{hash:e,faces:t,objects:a,sharpness:n,histograms:i,composition:o}=this._analyze;if(0===Object.keys(this._analyze).length)return Promise.resolve({});const r=yield this.toImageData(),s=n||o||e&&e.method===A.HashMethod.LumaHash?U.sobel(r,n):null,d={};if(e)switch(e.method){case A.HashMethod.LumaHash:d.hash=j.lumaHash(s,e);break;case A.HashMethod.PHash:default:d.hash=j.phash(r,e.hashSize);}if(a&&(d.objects=yield V.detectObjects(r,a)),n&&(d.sharpness=Z.sharpness(s,n)),i&&(d.histograms=K.histograms(r,i)),o&&(d.composition=Q.composition(s,Object.assign({},o,{sharpnessAnalysis:d.sharpness}))),t&&(d.faces=yield V.detectFaces(r,t),n))for(const e of d.faces.slice(0,3)){const t={x:_(r.width*e.boundingBox.x),y:_(r.height*e.boundingBox.y),width:_(r.width*e.boundingBox.width),height:_(r.height*e.boundingBox.height)};e.sharpness=Z.sharpness(s,Object.assign({},n,{subselect:t}))}return d})}_applyLayers(e){if(!this._output.layers)return e;let t=e;for(const a of this._output.layers){const n=X.ImageData.toColorspace(a.imageData,e.colorspace);t=we.opacity(t,n,a.opacity)}return t}_applyNormalize(e){return!this._output.normalize||a(this._output.normalize)?e:J.normalize(e,this._output.normalize)}_applyCalibrate(e){return!this._output.calibrate||a(this._output.calibrate)?e:Pe.calibrate(e,this._output.calibrate)}_applyTone(e){return!this._output.tone||a(this._output.tone)?e:_e.tone(e,this._output.tone)}_applySharpen(e){return this._output.sharpen?Se.sharpen(e,this._output.sharpen):e}_applyEdges(e){if(!this._output.edges)return e;const t=this._output.edges;e=X.ImageData.toRGBA(e);let a=e;return t.blurSigma&&(a=be.gaussianBlur(e,{sigma:t.blurSigma})),a=U.sobel(a,t),t.method===A.EdgeMethod.Canny&&(a=De.canny(a,t)),a}_applyEffects(e){if(!this._output.effects)return e;let t=e;for(const a of this._output.effects)switch(a.type){case A.EffectType.Noise:const e=a.options||{};if(0===e.opacity)continue;const n=e.opacity||0.05,i=Be.noise(t.width,t.height,a.options),o=X.ImageData.toColorspace(i,t.colorspace);t=we.opacity(t,o,n);break;default:throw new Error(`Unrecognized type: ${a.type}`);}return t}toFile(e){return this.toBuffer().then((t)=>H.writeFileAsync(e,t))}static from(e){if(X.ImageData.probablyIs(e))return this._fromImageData(e);let t,a=e;if(xe.isParseable(a)){const e=xe.createDecoder(a);a=e.extractJPEG(),t=xe.parse(e)}return this._fromBuffer(a,{exif:t})}static _fromBuffer(){throw new Error('unimplemented')}static _fromImageData(){throw new Error('unimplemented')}}t.Image=i,q.instrumentation.wrapAllMethods(i.prototype),i._instrumentation=q.instrumentation});t(Me);var Re=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.subselect=function(e,t){if(0===t.top&&t.bottom===e.height&&0===t.left&&t.right===e.width)return e;X.ImageData.assert(e,[A.Colorspace.RGBA,A.Colorspace.RGB,A.Colorspace.Greyscale]);const a=t.right-t.left,n=t.bottom-t.top;for(var i=new Uint8Array(a*n*e.channels),o=Object.assign({},e,{width:a,height:n,data:i}),r=t.top;r<t.bottom;r++)for(var s=t.left;s<t.right;s++)for(var d=X.ImageData.indexFor(e,s,r),l=X.ImageData.indexFor(o,s-t.left,r-t.top),h=0;h<e.channels;h++)i[l+h]=e.data[d+h];return o}});t(Re);var Te=a(function(e,t){var a=x&&x.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,o){function r(e){try{d(n.next(e))}catch(t){o(t)}}function s(e){try{d(n['throw'](e))}catch(t){o(t)}}function d(e){e.done?i(e.value):new a(function(t){t(e.value)}).then(r,s)}d((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,'__esModule',{value:!0});class n extends Me.Image{constructor(e,t,a){super(),this._image=Promise.resolve(e),this._metadata=t,this._buffer=a}_applyEXIFOrientation(e){const t=this._metadata&&this._metadata.exif;if(!t||!t._raw.Orientation)return e;switch(t._raw.Orientation){case 1:break;case 3:e=X.ImageData.rotate(e,180);break;case 6:e=X.ImageData.rotate(e,270);break;case 8:e=X.ImageData.rotate(e,90);break;default:throw new Error(`Unable to handle orientation ${t._raw.Orientation}`);}return e}_applyResize(e){if(!this._output.resize)return e;const t=W.normalizeOptions(e,this._output.resize);if(t.doNotEnlarge){const{width:a=0,height:n=0}=e;if(a<t.width)return e;if(n<t.height)return e}switch(t.subselect&&(e=Re.subselect(e,t.subselect)),t.method){case A.ImageResizeMethod.NearestNeighbor:return W.nearestNeighbor(e,t);case A.ImageResizeMethod.Bilinear:default:return W.bilinear(e,t);}}_applyGreyscale(e){return this._output.greyscale?X.ImageData.toGreyscale(e):e}_applyAll(e){return a(this,void 0,void 0,function*(){let t=yield e;return t=yield this._applyEXIFOrientation(t),t=yield this._applyGreyscale(t),t=yield this._applyResize(t),t=yield this._applyLayers(t),t=yield this._applyNormalize(t),t=yield this._applyCalibrate(t),t=yield this._applyTone(t),t=yield this._applySharpen(t),t=yield this._applyEdges(t),t=yield this._applyEffects(t),t})}toMetadata(){return this._image.then((e)=>{return Object.assign({},this._metadata,{width:e.width,height:e.height,aspectRatio:e.width/e.height})})}toImageData(){return this._applyAll(this._image)}toBuffer(){return a(this,void 0,void 0,function*(){if(this._output.format&&this._output.format.type===A.ImageFormat.NoTranscode){if(!this._buffer)throw new Error('Unable to return original buffer');return this._buffer}return this._applyAll(this._image).then((e)=>X.ImageData.toBuffer(e,this._output.format||A.DEFAULT_FORMAT))})}static _fromBuffer(e,t){return new n(X.ImageData.from(e),t,e)}static _fromImageData(e){return new n(X.ImageData.normalize(e))}}t.BrowserImage=n,q.instrumentation.wrapAllMethods(n.prototype)});t(Te);var Ee=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.instrumentation=q.instrumentation,t.ImageData=X.ImageData;var a=j;t.hammingDistance=a.hammingDistance,t.subsetDistance=a.subsetDistance;var n=A;t.ImageFormat=n.ImageFormat,t.ImageResizeFit=n.ImageResizeFit,t.ImageResizeMethod=n.ImageResizeMethod,t.EdgeMethod=n.EdgeMethod,t.HashMethod=n.HashMethod,t.types=A,t.hashes=j});t(Ee);var ve=a(function(e,t){Object.defineProperty(t,'__esModule',{value:!0}),t.Image=Te.BrowserImage,function(e){for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a])}(Ee)}),Ge=t(ve),Ae=ve.Image;e['default']=Ge,e.Image=Ae,Object.defineProperty(e,'__esModule',{value:!0})});
//# sourceMappingURL=bundle.min.js.map
